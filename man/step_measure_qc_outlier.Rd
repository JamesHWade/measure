% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qc.R
\name{step_measure_qc_outlier}
\alias{step_measure_qc_outlier}
\title{Detect Outlier Samples}
\usage{
step_measure_qc_outlier(
  recipe,
  measures = NULL,
  method = c("mahalanobis", "pca"),
  threshold = 3,
  n_components = NULL,
  new_col = ".outlier",
  new_col_score = ".outlier_score",
  role = "predictor",
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("measure_qc_outlier")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{An optional character vector of measure column names.}

\item{method}{Detection method:
\itemize{
\item \code{"mahalanobis"} (default): Mahalanobis distance with robust covariance
\item \code{"pca"}: PCA score-based outliers (Hotelling's T^2)
}}

\item{threshold}{Threshold for outlier detection in standard deviation
units. Default is 3. Tunable via \code{\link[=outlier_threshold]{outlier_threshold()}}.}

\item{n_components}{For PCA method, number of components to use. Default
is \code{NULL} (auto-select based on variance explained).}

\item{new_col}{Name of the new outlier flag column. Default is \code{".outlier"}.}

\item{new_col_score}{Name of the outlier score column. Default is
\code{".outlier_score"}.}

\item{role}{Role for new columns. Default is \code{"predictor"}.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_measure_qc_outlier()} creates a \emph{specification} of a recipe step that
detects outlier samples using Mahalanobis distance or PCA-based methods.
A new column is added indicating outlier status.
}
\details{
Outlier samples can arise from measurement errors, sample preparation
issues, or genuine unusual samples. This step helps identify them.

\strong{Mahalanobis method}: Computes the multivariate distance from each sample
to the center of the distribution, accounting for correlations. Uses robust
estimation of center and covariance via median and MAD.

\strong{PCA method}: Projects data onto principal components and computes
Hotelling's T^2 statistic. Samples with extreme scores are flagged.

Two columns are added:
\itemize{
\item \code{.outlier}: Logical flag
\item \code{.outlier_score}: Numeric score (higher = more extreme)
}
}
\examples{
library(recipes)

rec <- recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_qc_outlier(threshold = 3) |>
  prep()

bake(rec, new_data = NULL)
}
\seealso{
Other measure-qc: 
\code{\link{step_measure_impute}()},
\code{\link{step_measure_qc_saturated}()},
\code{\link{step_measure_qc_snr}()}
}
\concept{measure-qc}
