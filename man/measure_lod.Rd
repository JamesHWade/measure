% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lod-loq.R
\name{measure_lod}
\alias{measure_lod}
\title{Calculate Limit of Detection (LOD)}
\usage{
measure_lod(
  data,
  response_col,
  method = c("blank_sd", "calibration", "sn", "precision"),
  conc_col = "nominal_conc",
  sample_type_col = "sample_type",
  calibration = NULL,
  k = 3,
  sn_col = NULL,
  noise = NULL,
  sn_threshold = 3,
  ...
)
}
\arguments{
\item{data}{A data frame containing the measurement data.}

\item{response_col}{Name of the response column.}

\item{method}{Method for LOD calculation:
\itemize{
\item \code{"blank_sd"}: 3 * SD of blank samples (requires \code{sample_type == "blank"})
\item \code{"calibration"}: 3.3 * sigma / slope from calibration curve
\item \code{"sn"}: Signal-to-noise ratio method (requires \code{sn_col} or noise estimate)
\item \code{"precision"}: Based on acceptable precision at low concentrations
}}

\item{conc_col}{Name of concentration column (for calibration method).}

\item{sample_type_col}{Name of sample type column. Default is \code{"sample_type"}.}

\item{calibration}{Optional \link{measure_calibration} object for calibration method.}

\item{k}{Multiplier for SD. Default is 3 for LOD.}

\item{sn_col}{Column containing S/N ratios (for \code{"sn"} method).}

\item{noise}{Noise estimate for S/N calculation (alternative to \code{sn_col}).}

\item{sn_threshold}{S/N threshold for LOD (default 3).}

\item{...}{Additional arguments passed to method-specific calculations.}
}
\value{
A \code{measure_lod} object containing:
\itemize{
\item \code{value}: The LOD value
\item \code{method}: Method used
\item \code{parameters}: Method-specific parameters
\item \code{uncertainty}: Uncertainty estimate (when available)
}
}
\description{
Calculates the limit of detection using one of several accepted methods.
The method used is explicitly documented in the output.
}
\details{
\subsection{Blank SD Method}{

LOD = mean(blank) + k * SD(blank)

Where k is typically 3. This is a simple but widely accepted approach.
}

\subsection{Calibration Method}{

LOD = k * sigma / slope

Where sigma is the residual standard error of the calibration curve
and slope is the calibration slope. k is typically 3.3 for LOD.
}

\subsection{Signal-to-Noise Method}{

LOD is the concentration where S/N = threshold (typically 3:1).
}

\subsection{Precision-Based Method}{

LOD is the lowest concentration where precision (CV) meets
a specified criterion.
}
}
\examples{
# Create sample data with blanks
data <- data.frame(
  sample_type = c(rep("blank", 10), rep("standard", 5)),
  response = c(rnorm(10, mean = 0.5, sd = 0.1),
               c(5, 15, 35, 70, 150)),
  nominal_conc = c(rep(0, 10), c(10, 25, 50, 100, 200))
)

# LOD from blank SD
measure_lod(data, "response", method = "blank_sd")

# LOD from calibration curve
cal <- measure_calibration_fit(
  data[data$sample_type == "standard", ],
  response ~ nominal_conc
)
measure_lod(data, "response", method = "calibration", calibration = cal)

}
\seealso{
\code{\link[=measure_loq]{measure_loq()}} for limit of quantitation,
\code{\link[=measure_lod_loq]{measure_lod_loq()}} for calculating both together.
}
