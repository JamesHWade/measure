% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reference-subtract.R
\name{step_measure_ratio_reference}
\alias{step_measure_ratio_reference}
\title{Compute Ratio to Reference Spectrum}
\usage{
step_measure_ratio_reference(
  recipe,
  reference,
  blank = NULL,
  measures = NULL,
  role = NA,
  trained = FALSE,
  learned_ref = NULL,
  learned_blank = NULL,
  skip = FALSE,
  id = recipes::rand_id("measure_ratio_reference")
)
}
\arguments{
\item{recipe}{A recipe object. The step will be added to the sequence of
operations for this recipe.}

\item{reference}{A required external reference spectrum. Can be:
\itemize{
\item A \code{measure_tbl} object with \code{location} and \code{value} columns
\item A numeric vector (must match the number of locations in data)
\item A data.frame with \code{location} and \code{value} columns (will be interpolated)
}}

\item{blank}{An optional blank spectrum to subtract from both sample and
reference before computing the ratio. Same format options as \code{reference}.}

\item{measures}{An optional character vector of measure column names to
process. If \code{NULL} (the default), all measure columns (columns with class
\code{measure_list}) will be processed.}

\item{role}{Not used by this step since no new variables are created.}

\item{trained}{A logical to indicate if the quantities for preprocessing
have been estimated.}

\item{learned_ref}{A named list containing the validated reference values for
each measure column. This is \code{NULL} until the step is trained.}

\item{learned_blank}{A named list containing the learned blank values for
each measure column. This is \code{NULL} until the step is trained.}

\item{skip}{A logical. Should the step be skipped when the recipe is baked?}

\item{id}{A character string that is unique to this step to identify it.}
}
\value{
An updated version of \code{recipe} with the new step added.
}
\description{
\code{step_measure_ratio_reference()} creates a \emph{specification} of a recipe step
that computes the ratio of each spectrum to a reference, optionally with
blank subtraction.
}
\details{
This step computes a ratio relative to a reference spectrum:
\itemize{
\item Without blank: \code{result = sample / reference}
\item With blank: \code{result = (sample - blank) / (reference - blank)}
}

This is useful for computing relative measurements, such as absorbance
from transmittance when you have both sample and reference scans.
}
\examples{
library(recipes)

# Create reference and blank spectra
ref_spectrum <- rep(1.0, 100)
blank_spectrum <- rep(0.05, 100)

rec <- recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_ratio_reference(
    reference = ref_spectrum,
    blank = blank_spectrum
  )
}
\seealso{
\code{\link[=step_measure_subtract_blank]{step_measure_subtract_blank()}} for simple blank subtraction

Other measure-preprocessing: 
\code{\link{step_measure_absorbance}()},
\code{\link{step_measure_calibrate_x}()},
\code{\link{step_measure_calibrate_y}()},
\code{\link{step_measure_derivative}()},
\code{\link{step_measure_derivative_gap}()},
\code{\link{step_measure_emsc}()},
\code{\link{step_measure_kubelka_munk}()},
\code{\link{step_measure_log}()},
\code{\link{step_measure_map}()},
\code{\link{step_measure_msc}()},
\code{\link{step_measure_normalize_istd}()},
\code{\link{step_measure_osc}()},
\code{\link{step_measure_snv}()},
\code{\link{step_measure_subtract_blank}()},
\code{\link{step_measure_subtract_reference}()},
\code{\link{step_measure_transmittance}()}
}
\concept{measure-preprocessing}
