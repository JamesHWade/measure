% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reference-subtract.R
\name{step_measure_subtract_reference}
\alias{step_measure_subtract_reference}
\title{Subtract or Divide by Reference Spectrum}
\usage{
step_measure_subtract_reference(
  recipe,
  reference,
  method = "subtract",
  measures = NULL,
  role = NA,
  trained = FALSE,
  learned_ref = NULL,
  skip = FALSE,
  id = recipes::rand_id("measure_subtract_reference")
)
}
\arguments{
\item{recipe}{A recipe object. The step will be added to the sequence of
operations for this recipe.}

\item{reference}{A required external reference spectrum. Can be:
\itemize{
\item A \code{measure_tbl} object with \code{location} and \code{value} columns
\item A numeric vector (must match the number of locations in data)
\item A data.frame with \code{location} and \code{value} columns (will be interpolated)
}}

\item{method}{The correction method to apply:
\itemize{
\item \code{"subtract"} (default): Subtract the blank from each spectrum
\item \code{"divide"}: Divide each spectrum by the blank
}}

\item{measures}{An optional character vector of measure column names to
process. If \code{NULL} (the default), all measure columns (columns with class
\code{measure_list}) will be processed.}

\item{role}{Not used by this step since no new variables are created.}

\item{trained}{A logical to indicate if the quantities for preprocessing
have been estimated.}

\item{learned_ref}{A named list containing the validated reference values for
each measure column. This is \code{NULL} until the step is trained.}

\item{skip}{A logical. Should the step be skipped when the recipe is baked?}

\item{id}{A character string that is unique to this step to identify it.}
}
\value{
An updated version of \code{recipe} with the new step added.
}
\description{
\code{step_measure_subtract_reference()} creates a \emph{specification} of a recipe
step that subtracts or divides each spectrum by an external reference.
This is a simpler version of \code{\link[=step_measure_subtract_blank]{step_measure_subtract_blank()}} that always
uses an externally provided reference.
}
\details{
This step applies a simple reference correction to each spectrum:
\itemize{
\item \code{method = "subtract"}: \code{result = sample - reference}
\item \code{method = "divide"}: \code{result = sample / reference}
}

Unlike \code{\link[=step_measure_subtract_blank]{step_measure_subtract_blank()}}, this step always requires an
externally provided reference and does not support learning from training
data.
}
\examples{
library(recipes)

# Create a reference spectrum
ref_spectrum <- rep(1.0, 100)

rec <- recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_subtract_reference(reference = ref_spectrum, method = "divide")
}
\seealso{
\code{\link[=step_measure_subtract_blank]{step_measure_subtract_blank()}} for blank correction with learning

Other measure-preprocessing: 
\code{\link{step_measure_absorbance}()},
\code{\link{step_measure_calibrate_x}()},
\code{\link{step_measure_calibrate_y}()},
\code{\link{step_measure_derivative}()},
\code{\link{step_measure_derivative_gap}()},
\code{\link{step_measure_kubelka_munk}()},
\code{\link{step_measure_log}()},
\code{\link{step_measure_map}()},
\code{\link{step_measure_msc}()},
\code{\link{step_measure_normalize_istd}()},
\code{\link{step_measure_ratio_reference}()},
\code{\link{step_measure_snv}()},
\code{\link{step_measure_subtract_blank}()},
\code{\link{step_measure_transmittance}()}
}
\concept{measure-preprocessing}
