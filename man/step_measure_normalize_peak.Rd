% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/normalize-sample.R
\name{step_measure_normalize_peak}
\alias{step_measure_normalize_peak}
\title{Normalize to a Specific Peak Region}
\usage{
step_measure_normalize_peak(
  recipe,
  measures = NULL,
  role = NA,
  trained = FALSE,
  location_min = NULL,
  location_max = NULL,
  method = "mean",
  skip = FALSE,
  id = recipes::rand_id("measure_normalize_peak")
)
}
\arguments{
\item{recipe}{A recipe object. The step will be added to the sequence of
operations for this recipe.}

\item{measures}{An optional character vector of measure column names to
process. If \code{NULL} (the default), all measure columns (columns with class
\code{measure_list}) will be processed. Use this to limit processing to specific
measure columns when working with multiple measurement types.}

\item{role}{Not used by this step since no new variables are created.}

\item{trained}{A logical to indicate if the quantities for preprocessing
have been estimated.}

\item{location_min}{Numeric. The lower bound of the region to use for
normalization. This parameter is tunable with \code{\link[=peak_location_min]{peak_location_min()}}.}

\item{location_max}{Numeric. The upper bound of the region to use for
normalization. This parameter is tunable with \code{\link[=peak_location_max]{peak_location_max()}}.}

\item{method}{Character. The summary statistic to compute from the region.
One of \code{"mean"} (default), \code{"max"}, or \code{"integral"}.}

\item{skip}{A logical. Should the step be skipped when the recipe is baked
by \code{\link[recipes:bake]{recipes::bake()}}? While all operations are baked when \code{\link[recipes:prep]{recipes::prep()}} is run, some
operations may not be able to be conducted on new data (e.g. processing
the outcome variable(s)). Care should be taken when using \code{skip = TRUE}
as it may affect the computations for subsequent operations.}

\item{id}{A character string that is unique to this step to identify it.}
}
\value{
An updated version of \code{recipe} with the new step added to the
sequence of any existing operations.
}
\description{
\code{step_measure_normalize_peak()} creates a \emph{specification} of a recipe step that
divides each spectrum by a summary statistic computed from a specified region.
This is commonly used for internal standard normalization.
}
\details{
For each spectrum, this step:
\enumerate{
\item Selects values in the region \verb{[location_min, location_max]}
\item Computes a summary statistic (mean, max, or integral) from that region
\item Divides the entire spectrum by this value
}

This is useful when you have an internal standard peak at a known location
and want to normalize all spectra to that peak.

The \code{location_min} and \code{location_max} parameters are tunable with
\code{\link[=peak_location_min]{peak_location_min()}} and \code{\link[=peak_location_max]{peak_location_max()}} for hyperparameter
optimization.

If no values fall within the specified region, an error is raised. If the
computed normalizer is zero or NA, a warning is issued and the original
values are returned unchanged.

\strong{No selectors should be supplied to this step function}. The data should be
in the internal format produced by \code{\link[=step_measure_input_wide]{step_measure_input_wide()}} or
\code{\link[=step_measure_input_long]{step_measure_input_long()}}.
}
\examples{
library(recipes)

# Normalize to mean of region 40-60
rec <-
  recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_normalize_peak(location_min = 40, location_max = 60) |>
  prep()

bake(rec, new_data = NULL)
}
\seealso{
\code{\link[=step_measure_normalize_max]{step_measure_normalize_max()}}, \code{\link[=step_measure_normalize_auc]{step_measure_normalize_auc()}},
\code{\link[=peak_location_min]{peak_location_min()}}, \code{\link[=peak_location_max]{peak_location_max()}}

Other measure-normalization: 
\code{\link{step_measure_normalize_auc}()},
\code{\link{step_measure_normalize_max}()},
\code{\link{step_measure_normalize_range}()},
\code{\link{step_measure_normalize_sum}()},
\code{\link{step_measure_normalize_vector}()}
}
\concept{measure-normalization}
