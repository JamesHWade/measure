% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lod-loq.R
\name{measure_loq}
\alias{measure_loq}
\title{Calculate Limit of Quantitation (LOQ)}
\usage{
measure_loq(
  data,
  response_col,
  method = c("blank_sd", "calibration", "sn", "precision"),
  conc_col = "nominal_conc",
  sample_type_col = "sample_type",
  calibration = NULL,
  k = 10,
  sn_col = NULL,
  noise = NULL,
  sn_threshold = 10,
  precision_cv = 20,
  ...
)
}
\arguments{
\item{data}{A data frame containing the measurement data.}

\item{response_col}{Name of the response column.}

\item{method}{Method for LOD calculation:
\itemize{
\item \code{"blank_sd"}: 3 * SD of blank samples (requires \code{sample_type == "blank"})
\item \code{"calibration"}: 3.3 * sigma / slope from calibration curve
\item \code{"sn"}: Signal-to-noise ratio method (requires \code{sn_col} or noise estimate)
\item \code{"precision"}: Based on acceptable precision at low concentrations
}}

\item{conc_col}{Name of concentration column (for calibration method).}

\item{sample_type_col}{Name of sample type column. Default is \code{"sample_type"}.}

\item{calibration}{Optional \link{measure_calibration} object for calibration method.}

\item{k}{Multiplier for SD. Default is 10 for LOQ.}

\item{sn_col}{Column containing S/N ratios (for \code{"sn"} method).}

\item{noise}{Noise estimate for S/N calculation (alternative to \code{sn_col}).}

\item{sn_threshold}{S/N threshold for LOQ (default 10).}

\item{precision_cv}{Maximum allowable CV for LOQ (default 20\%).}

\item{...}{Additional arguments passed to method-specific calculations.}
}
\value{
A \code{measure_loq} object containing:
\itemize{
\item \code{value}: The LOQ value
\item \code{method}: Method used
\item \code{parameters}: Method-specific parameters
\item \code{uncertainty}: Uncertainty estimate (when available)
}
}
\description{
Calculates the limit of quantitation using one of several accepted methods.
The method used is explicitly documented in the output.
}
\details{
\subsection{Blank SD Method}{

LOQ = mean(blank) + k * SD(blank)

Where k is typically 10. This is a simple but widely accepted approach.
}

\subsection{Calibration Method}{

LOQ = k * sigma / slope

Where sigma is the residual standard error of the calibration curve
and slope is the calibration slope. k is typically 10 for LOQ.
}

\subsection{Signal-to-Noise Method}{

LOQ is the concentration where S/N = threshold (typically 10:1).
}

\subsection{Precision-Based Method}{

LOQ is the lowest concentration where precision (CV) is <= the
specified criterion (typically 20\% for bioanalytical methods).
}
}
\examples{
# Create sample data with blanks
data <- data.frame(
  sample_type = c(rep("blank", 10), rep("standard", 5)),
  response = c(rnorm(10, mean = 0.5, sd = 0.1),
               c(5, 15, 35, 70, 150)),
  nominal_conc = c(rep(0, 10), c(10, 25, 50, 100, 200))
)

# LOQ from blank SD
measure_loq(data, "response", method = "blank_sd")

}
\seealso{
\code{\link[=measure_lod]{measure_lod()}} for limit of detection,
\code{\link[=measure_lod_loq]{measure_lod_loq()}} for calculating both together.
}
