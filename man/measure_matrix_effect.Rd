% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/matrix-effects.R
\name{measure_matrix_effect}
\alias{measure_matrix_effect}
\title{Matrix Effect Analysis}
\usage{
measure_matrix_effect(
  data,
  response_col,
  sample_type_col,
  matrix_level,
  neat_level,
  concentration_col = NULL,
  analyte_col = NULL,
  group_cols = NULL,
  conf_level = 0.95
)
}
\arguments{
\item{data}{A data frame containing response data.}

\item{response_col}{Name of the column containing analyte responses.}

\item{sample_type_col}{Name of the column indicating sample type
(matrix vs neat/standard).}

\item{matrix_level}{Value in \code{sample_type_col} indicating matrix samples.}

\item{neat_level}{Value in \code{sample_type_col} indicating neat/standard samples.}

\item{concentration_col}{Optional column for concentration levels.
If provided, matrix effects are calculated per concentration.}

\item{analyte_col}{Optional column for analyte names.
If provided, matrix effects are calculated per analyte.}

\item{group_cols}{Additional grouping columns (e.g., batch, matrix source).}

\item{conf_level}{Confidence level for intervals. Default is 0.95.}
}
\value{
A \code{measure_matrix_effect} object containing:
\itemize{
\item \code{results}: Tibble with matrix effect percentages per group
\item \code{statistics}: Overall summary statistics
\item \code{raw_data}: Data used for calculations
}
}
\description{
Quantifies matrix effects (ion suppression/enhancement) by comparing
analyte response in matrix versus neat solution. This is essential for
validating LC-MS/MS and other analytical methods where matrix interference
is a concern.
}
\details{
\subsection{Matrix Effect Calculation}{

Matrix effect (ME\%) is calculated as:
\verb{ME\% = (response_in_matrix / response_in_neat) * 100}

Or equivalently:
\verb{ME\% = 100 + ((response_in_matrix - response_in_neat) / response_in_neat) * 100}
}

\subsection{Interpretation}{
\itemize{
\item \strong{ME = 100\%}: No matrix effect
\item \strong{ME > 100\%}: Ion enhancement
\item \strong{ME < 100\%}: Ion suppression
}
}

\subsection{Acceptance Criteria (typical)}{

According to ICH M10 and FDA guidance:
\itemize{
\item ME should be between 80-120\% (±20\%)
\item CV of ME should be ≤15\%
}
}

\subsection{Experimental Design}{

To assess matrix effects:
\enumerate{
\item Prepare blank matrix (e.g., plasma) from multiple sources
\item Spike analyte post-extraction at known concentration
\item Compare to analyte in neat solvent at same concentration
}
}
}
\examples{
# Matrix effect study data
me_data <- data.frame(
  sample_type = rep(c("matrix", "neat"), each = 6),
  matrix_lot = rep(c("Lot1", "Lot2", "Lot3", "Lot1", "Lot2", "Lot3"), 2),
  concentration = rep(c("low", "high"), each = 3, times = 2),
  response = c(
    # Matrix samples (some suppression)
    9500, 9800, 9200, 48000, 49500, 47000,
    # Neat samples
    10000, 10000, 10000, 50000, 50000, 50000
  )
)

me <- measure_matrix_effect(
  me_data,
  response_col = "response",
  sample_type_col = "sample_type",
  matrix_level = "matrix",
  neat_level = "neat",
  concentration_col = "concentration"
)

print(me)
tidy(me)
}
\seealso{
\code{\link[=step_measure_standard_addition]{step_measure_standard_addition()}}, \code{\link[=measure_accuracy]{measure_accuracy()}}

Other calibration: 
\code{\link{step_measure_dilution_correct}()},
\code{\link{step_measure_standard_addition}()},
\code{\link{step_measure_surrogate_recovery}()}
}
\concept{calibration}
