% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/drift-correction.R
\name{step_measure_drift_linear}
\alias{step_measure_drift_linear}
\title{Linear Drift Correction}
\usage{
step_measure_drift_linear(
  recipe,
  ...,
  run_order_col = "run_order",
  sample_type_col = "sample_type",
  qc_type = "qc",
  apply_to = c("all", "unknown"),
  min_qc = 3,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("measure_drift_linear")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{...}{One or more selector functions to choose feature columns. For
feature-level data, select the numeric response columns. For curve-level
data with \code{.measures}, leave empty to apply to all locations.}

\item{run_order_col}{Name of the column containing run order (injection
sequence). Must be numeric/integer.}

\item{sample_type_col}{Name of the column containing sample type.}

\item{qc_type}{Value(s) in \code{sample_type_col} that identify QC samples to
use for drift modeling. Default is \code{"qc"}.}

\item{apply_to}{Which samples to apply correction to:
\itemize{
\item \code{"all"} (default): Correct all samples
\item \code{"unknown"}: Only correct unknown samples
}}

\item{min_qc}{Minimum number of QC samples required. Default is 5.}

\item{role}{Not used by this step.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_measure_drift_linear()} creates a \emph{specification} of a recipe step
that corrects for linear signal drift across run order using QC or reference
samples. This is a simpler alternative to LOESS when drift is approximately
linear.
}
\details{
\subsection{How It Works}{
\enumerate{
\item During \code{prep()}: A linear regression is fit to QC sample responses vs
run order for each feature.
\item During \code{bake()}: Correction factors are calculated as:
\code{correction = median(QC_responses) / predicted_value}

Each sample's response is multiplied by the correction factor.
}
}

\subsection{When to Use}{

Use linear drift correction when:
\itemize{
\item Drift is approximately linear over the run
\item You have fewer QC samples (requires at least 3)
\item You want a more conservative correction
}

For non-linear drift patterns, use \code{\link[=step_measure_drift_qc_loess]{step_measure_drift_qc_loess()}} or
\code{\link[=step_measure_drift_spline]{step_measure_drift_spline()}}.
}
}
\examples{
library(recipes)

# Data with linear drift
data <- data.frame(
  sample_id = paste0("S", 1:20),
  sample_type = rep(c("qc", "unknown", "unknown", "unknown", "qc"), 4),
  run_order = 1:20,
  feature1 = 100 + (1:20) * 0.5 + rnorm(20, sd = 2)
)

rec <- recipe(~ ., data = data) |>
  update_role(sample_id, new_role = "id") |>
  step_measure_drift_linear(feature1) |>
  prep()

corrected <- bake(rec, new_data = NULL)
}
\seealso{
\code{\link[=step_measure_drift_qc_loess]{step_measure_drift_qc_loess()}} for LOESS-based correction,
\code{\link[=step_measure_drift_spline]{step_measure_drift_spline()}} for spline-based correction.

Other drift-correction: 
\code{\link{step_measure_drift_qc_loess}()},
\code{\link{step_measure_drift_spline}()},
\code{\link{step_measure_qc_bracket}()}
}
\concept{drift-correction}
