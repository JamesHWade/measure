% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/baseline-als.R
\name{step_measure_baseline_als}
\alias{step_measure_baseline_als}
\title{Asymmetric Least Squares (ALS) Baseline Correction}
\usage{
step_measure_baseline_als(
  recipe,
  measures = NULL,
  lambda = 1e+06,
  p = 0.01,
  max_iter = 20L,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("measure_baseline_als")
)
}
\arguments{
\item{recipe}{A recipe object. The step will be added to the sequence of
operations for this recipe.}

\item{measures}{An optional character vector of measure column names to
process. If \code{NULL} (the default), all measure columns (columns with class
\code{measure_list}) will be processed.}

\item{lambda}{Smoothness parameter (2nd derivative constraint). Higher values
produce smoother baselines. Default is \code{1e6}. Typical range is 1e3 to 1e9.
Tunable via \code{\link[=baseline_lambda]{baseline_lambda()}}.}

\item{p}{Asymmetry parameter controlling weight for positive residuals.
Values near 0 (e.g., 0.001-0.05) work well for spectra with peaks above
baseline. Default is \code{0.01}. Tunable via \code{\link[=baseline_asymmetry]{baseline_asymmetry()}}.}

\item{max_iter}{Maximum number of iterations. Default is \code{20}.}

\item{role}{Not used by this step since no new variables are created.}

\item{trained}{A logical to indicate if the quantities for preprocessing
have been estimated.}

\item{skip}{A logical. Should the step be skipped when the recipe is baked?}

\item{id}{A character string that is unique to this step to identify it.}
}
\value{
An updated version of \code{recipe} with the new step added to the
sequence of any existing operations.
}
\description{
\code{step_measure_baseline_als()} creates a \emph{specification} of a recipe step that
applies Asymmetric Least Squares baseline correction to measurement data.
ALS iteratively fits a smooth baseline giving less weight to points above
the baseline (peaks).
}
\details{
Asymmetric Least Squares (ALS) baseline correction uses a Whittaker smoother
with asymmetric weights to fit a baseline that follows the lower envelope of
the spectrum. The algorithm iteratively:

1

. Fits a smooth baseline using penalized least squares
2. Calculates residuals (spectrum - baseline)
3. Assigns weights: \code{p} for positive residuals (peaks), \code{1-p} for negative
4. Repeats until convergence or max iterations

The smoothness is controlled by \code{lambda}, which penalizes the second
derivative of the baseline. Larger \code{lambda} produces smoother baselines.

ALS is particularly effective for:
\itemize{
\item NIR/IR spectroscopy with broad baseline drift
\item Raman spectroscopy with fluorescence background
\item UV-Vis spectroscopy with scattering effects
}

\strong{No selectors should be supplied to this step function}. The data should be
in the internal format produced by \code{\link[=step_measure_input_wide]{step_measure_input_wide()}} or
\code{\link[=step_measure_input_long]{step_measure_input_long()}}.
}
\section{Tidying}{
When you \code{\link[recipes:tidy.recipe]{tidy()}} this step, a tibble with columns
\code{terms}, \code{lambda}, \code{p}, and \code{id} is returned.
}

\section{Tuning}{
This step has parameters that can be tuned:
\itemize{
\item \code{lambda}: Use \code{\link[=baseline_lambda]{baseline_lambda()}} (log10 scale recommended)
\item \code{p}: Use \code{\link[=baseline_asymmetry]{baseline_asymmetry()}}
}
}

\examples{
library(recipes)

\donttest{
rec <- recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_baseline_als(lambda = 1e6, p = 0.01) |>
  prep()

bake(rec, new_data = NULL)
}
}
\references{
Eilers, P.H.C. and Boelens, H.F.M. (2005). Baseline Correction with
Asymmetric Least Squares Smoothing. Leiden University Medical Centre report.
}
\seealso{
Other measure-baseline: 
\code{\link{step_measure_baseline_airpls}()},
\code{\link{step_measure_baseline_arpls}()},
\code{\link{step_measure_baseline_auto}()},
\code{\link{step_measure_baseline_custom}()},
\code{\link{step_measure_baseline_gpc}()},
\code{\link{step_measure_baseline_minima}()},
\code{\link{step_measure_baseline_morph}()},
\code{\link{step_measure_baseline_poly}()},
\code{\link{step_measure_baseline_py}()},
\code{\link{step_measure_baseline_rf}()},
\code{\link{step_measure_baseline_rolling}()},
\code{\link{step_measure_baseline_snip}()},
\code{\link{step_measure_baseline_tophat}()},
\code{\link{step_measure_detrend}()}
}
\concept{measure-baseline}
