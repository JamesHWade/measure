% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/baseline-rf.R
\name{step_measure_baseline_rf}
\alias{step_measure_baseline_rf}
\title{Robust Fitting Baseline Correction}
\usage{
step_measure_baseline_rf(
  recipe,
  measures = NULL,
  span = 2/3,
  maxit = c(5L, 5L),
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("measure_baseline_rf")
)
}
\arguments{
\item{recipe}{A recipe object. The step will be added to the sequence of
operations for this recipe.}

\item{measures}{An optional character vector of measure column names to
process. If \code{NULL} (the default), all measure columns (columns with class
\code{measure_list}) will be processed.}

\item{span}{Controls the amount of smoothing. This is the fraction of data
used in computing each fitted value. Default is \code{2/3}. Smaller values
produce less smooth baselines that follow local features more closely.}

\item{maxit}{A length-2 integer vector specifying the number of iterations
for the robust fit. The first value is for the asymmetric weighting
function, the second for symmetric weighting. Default is \code{c(5, 5)}.}

\item{role}{Not used by this step since no new variables are created.}

\item{trained}{A logical to indicate if the quantities for preprocessing
have been estimated.}

\item{skip}{A logical. Should the step be skipped when the recipe is baked?}

\item{id}{A character string that is unique to this step to identify it.}
}
\value{
An updated version of \code{recipe} with the new step added to the
sequence of any existing operations.
}
\description{
\code{step_measure_baseline_rf()} creates a \emph{specification} of a recipe step
that applies robust fitting baseline correction to measurement data. This
method uses local regression with iterative reweighting to fit a baseline
that is resistant to peaks.
}
\details{
Robust fitting baseline correction uses local polynomial regression
(LOESS/LOWESS) with iterative reweighting to estimate the baseline. The
algorithm uses asymmetric weights in initial iterations to down-weight
peaks, then symmetric weights for final smoothing.

This method is particularly effective for:
\itemize{
\item Spectra with peaks of varying widths
\item Data where the baseline shape is not well-described by a polynomial
\item Situations where peaks should not influence the baseline estimate
}

The \code{span} parameter controls the trade-off between smoothness and local
adaptation:
\itemize{
\item Larger span (e.g., 0.8): Smoother baseline, may miss local variations
\item Smaller span (e.g., 0.3): More local adaptation, may overfit
}

\strong{No selectors should be supplied to this step function}. The data should be
in the internal format produced by \code{\link[=step_measure_input_wide]{step_measure_input_wide()}} or
\code{\link[=step_measure_input_long]{step_measure_input_long()}}.
}
\section{Tidying}{
When you \code{\link[recipes:tidy.recipe]{tidy()}} this step, a tibble with columns
\code{terms}, \code{span}, and \code{id} is returned.
}

\examples{
library(recipes)

rec <- recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_baseline_rf(span = 0.5) |>
  prep()

bake(rec, new_data = NULL)
}
\seealso{
\code{\link[=subtract_rf_baseline]{subtract_rf_baseline()}} for the standalone function this step wraps.

Other measure-baseline: 
\code{\link{step_measure_baseline_airpls}()},
\code{\link{step_measure_baseline_als}()},
\code{\link{step_measure_baseline_arpls}()},
\code{\link{step_measure_baseline_aspls}()},
\code{\link{step_measure_baseline_auto}()},
\code{\link{step_measure_baseline_custom}()},
\code{\link{step_measure_baseline_fastchrom}()},
\code{\link{step_measure_baseline_gpc}()},
\code{\link{step_measure_baseline_iarpls}()},
\code{\link{step_measure_baseline_minima}()},
\code{\link{step_measure_baseline_morph}()},
\code{\link{step_measure_baseline_morphological}()},
\code{\link{step_measure_baseline_poly}()},
\code{\link{step_measure_baseline_py}()},
\code{\link{step_measure_baseline_rolling}()},
\code{\link{step_measure_baseline_snip}()},
\code{\link{step_measure_baseline_tophat}()},
\code{\link{step_measure_detrend}()}
}
\concept{measure-baseline}
