% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/align.R
\name{step_measure_align_cow}
\alias{step_measure_align_cow}
\title{Correlation Optimized Warping Alignment}
\usage{
step_measure_align_cow(
  recipe,
  measures = NULL,
  reference = c("mean", "median", "first"),
  segment_length = 30L,
  slack = 1L,
  role = NA,
  trained = FALSE,
  skip = FALSE,
  id = recipes::rand_id("measure_align_cow")
)
}
\arguments{
\item{recipe}{A recipe object.}

\item{measures}{An optional character vector of measure column names.}

\item{reference}{How to determine the reference:
\code{"mean"} (default, mean spectrum from training),
\code{"median"} (median spectrum from training), or
\code{"first"} (first sample).}

\item{segment_length}{Length of each segment for warping. Default is 30.
Tunable via \code{\link[=align_segment_length]{align_segment_length()}}.}

\item{slack}{Maximum compression/expansion per segment in points. Default is 1.
A slack of 1 means each segment can shrink or expand by 1 point.}

\item{role}{Not used.}

\item{trained}{Logical indicating if the step has been trained.}

\item{skip}{Logical. Should the step be skipped when baking?}

\item{id}{Unique step identifier.}
}
\value{
An updated recipe with the new step added.
}
\description{
\code{step_measure_align_cow()} creates a \emph{specification} of a recipe step that
aligns spectra using Correlation Optimized Warping (COW). This method uses
piecewise linear warping to correct for non-linear shifts.
}
\details{
Correlation Optimized Warping (COW) divides signals into segments and uses
dynamic programming to find the optimal piecewise linear warping that
maximizes correlation with the reference spectrum.

Key parameters:
\itemize{
\item \code{segment_length}: Controls the resolution of warping. Smaller segments
allow more local corrections but increase computation.
\item \code{slack}: Controls how much each segment can stretch or compress.
Larger values allow more flexibility but may introduce artifacts.
}

This is a pure R implementation based on Nielsen et al. (1998).
}
\examples{
library(recipes)

rec <- recipe(water + fat + protein ~ ., data = meats_long) |>
  update_role(id, new_role = "id") |>
  step_measure_input_long(transmittance, location = vars(channel)) |>
  step_measure_align_cow(segment_length = 20, slack = 2) |>
  prep()

bake(rec, new_data = NULL)
}
\references{
Nielsen, N.P.V., Carstensen, J.M., and Smedsgaard, J. (1998).
Aligning of single and multiple wavelength chromatographic profiles
for chemometric data analysis using correlation optimised warping.
Journal of Chromatography A, 805, 17-35.
}
\seealso{
Other measure-align: 
\code{\link{step_measure_align_dtw}()},
\code{\link{step_measure_align_ptw}()},
\code{\link{step_measure_align_reference}()},
\code{\link{step_measure_align_shift}()}
}
\concept{measure-align}
