[{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement codeofconduct@rstudio.com. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to anylr","title":"Contributing to anylr","text":"outlines propose change anylr. detailed info contributing , tidyverse packages, please see development contributing guide.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to anylr","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to anylr","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed).","code":""},{"path":"https://jameshwade.github.io/measure/dev/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to anylr","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"JamesHWade/anylr\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to anylr","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://jameshwade.github.io/measure/dev/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to anylr","text":"Please note anylr project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://jameshwade.github.io/measure/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 James Wade Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jameshwade.github.io/measure/dev/SUPPORT.html","id":null,"dir":"","previous_headings":"","what":"Getting help with anylr","title":"Getting help with anylr","text":"Thanks using anylr! filing issue, places explore pieces put together make process smooth possible.","code":""},{"path":"https://jameshwade.github.io/measure/dev/SUPPORT.html","id":"make-a-reprex","dir":"","previous_headings":"","what":"Make a reprex","title":"Getting help with anylr","text":"Start making minimal reproducible example using reprex package. haven’t heard used reprex , ’re treat! Seriously, reprex make R-question-asking endeavors easier (pretty insane ROI five ten minutes ’ll take learn ’s ). additional reprex pointers, check Get help! section tidyverse site.","code":""},{"path":"https://jameshwade.github.io/measure/dev/SUPPORT.html","id":"where-to-ask","dir":"","previous_headings":"","what":"Where to ask?","title":"Getting help with anylr","text":"Armed reprex, next step figure ask. ’s question: start community.rstudio.com, /StackOverflow. people answer questions. ’s bug: ’re right place, file issue. ’re sure: let community help figure ! problem bug feature request, can easily return report . opening new issue, sure search issues pull requests make sure bug hasn’t reported /already fixed development version. default, search pre-populated :issue :open. can edit qualifiers (e.g. :pr, :closed) needed. example, ’d simply remove :open search issues repo, open closed.","code":""},{"path":"https://jameshwade.github.io/measure/dev/SUPPORT.html","id":"what-happens-next","dir":"","previous_headings":"","what":"What happens next?","title":"Getting help with anylr","text":"efficient possible, development tidyverse packages tends bursty, shouldn’t worry don’t get immediate response. Typically don’t look repo sufficient quantity issues accumulates, ’s burst intense activity focus efforts. makes development efficient avoids expensive context switching problems, cost taking longer get back . process makes good reprex particularly important might multiple months initial report start working . can’t reproduce bug, can’t fix !","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Baseline Correction","text":"Baseline correction common preprocessing step spectroscopic data. Spectral baselines can drift due instrument effects, sample scattering, fluorescence, obscuring chemical information spectra. vignette demonstrates baseline correction techniques available measure.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"the-problem-baseline-drift","dir":"Articles","previous_headings":"","what":"The problem: Baseline drift","title":"Baseline Correction","text":"Let’s visualize baseline issues NIR spectra using meats dataset:  Notice vertical offset spectra? baseline shift isn’t related chemical composition want model.","code":"data(meats)  # Convert to long format for visualization meats_viz <- meats |>   mutate(id = row_number()) |>   pivot_longer(     cols = starts_with(\"x_\"),     names_to = \"channel\",     values_to = \"transmittance\"   ) |>   mutate(channel = as.integer(gsub(\"x_\", \"\", channel)))  # Plot raw spectra meats_viz |>   filter(id <= 20) |>   ggplot(aes(x = channel, y = transmittance, group = id, color = factor(id))) +   geom_line(alpha = 0.7) +   labs(     x = \"Channel\",     y = \"Transmittance\",     title = \"Raw NIR Spectra with Baseline Variation\"   ) +   theme_minimal() +   theme(legend.position = \"none\")"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"using-savitzky-golay-derivatives","dir":"Articles","previous_headings":"Baseline correction methods","what":"Using Savitzky-Golay derivatives","title":"Baseline Correction","text":"common approach baseline correction measure use derivatives via step_measure_savitzky_golay(). First derivatives remove constant baseline offsets, second derivatives remove linear baseline trends.","code":"library(recipes)  # First derivative removes constant baseline rec_d1 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 1)  processed <- bake(prep(rec_d1), new_data = NULL)  # Visualize corrected spectra plot_data <- processed |>   slice(1:20) |>   mutate(id = row_number()) |>   unnest(.measures)  ggplot(plot_data, aes(x = location, y = value, group = id, color = factor(id))) +   geom_line(alpha = 0.7) +   labs(     x = \"Channel\",     y = \"First Derivative\",     title = \"After First Derivative (Baseline Corrected)\"   ) +   theme_minimal() +   theme(legend.position = \"none\")"},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"using-the-robust-fitting-baseline-function","dir":"Articles","previous_headings":"Baseline correction methods","what":"Using the robust fitting baseline function","title":"Baseline Correction","text":"cases derivatives aren’t appropriate, measure provides subtract_rf_baseline(), fits robust local regression estimate subtract baseline:","code":"# Use the meats_long dataset included in measure data(meats_long)  # Apply robust baseline correction corrected <- meats_long |>   filter(id <= 20) |>   group_by(id) |>   subtract_rf_baseline(yvar = transmittance, span = 0.5)  # Compare before and after comparison <- meats_long |>   filter(id <= 20) |>   mutate(type = \"Raw\") |>   bind_rows(corrected |> mutate(type = \"Corrected\"))  ggplot(comparison, aes(x = channel, y = transmittance, group = interaction(id, type))) +   geom_line(alpha = 0.7) +   facet_wrap(~type) +   labs(     x = \"Channel\",     y = \"Transmittance\",     title = \"Robust Fitting Baseline Correction\"   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"adjusting-the-span-parameter","dir":"Articles","previous_headings":"Baseline correction methods","what":"Adjusting the span parameter","title":"Baseline Correction","text":"span parameter controls much data used local regression. Larger values produce smoother baselines:","code":"spans <- c(0.3, 0.5, 0.8)  span_comparison <- lapply(spans, function(s) {   meats_long |>     filter(id == 1) |>     group_by(id) |>     subtract_rf_baseline(yvar = transmittance, span = s) |>     mutate(span = paste(\"span =\", s)) }) |>   bind_rows()  ggplot(span_comparison, aes(x = channel, y = transmittance, color = span)) +   geom_line() +   labs(     x = \"Channel\",     y = \"Corrected Transmittance\",     title = \"Effect of Span on Baseline Correction\",     color = NULL   ) +   theme_minimal()"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"combining-with-other-preprocessing","dir":"Articles","previous_headings":"","what":"Combining with other preprocessing","title":"Baseline Correction","text":"Baseline correction often works best part complete preprocessing pipeline:","code":"# Complete preprocessing recipe rec_complete <- recipe(water + fat + protein ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   # First derivative for baseline correction   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   # SNV for scatter correction   step_measure_snv() |>   # Output for modeling   step_measure_output_wide(prefix = \"nir_\")  final_data <- bake(prep(rec_complete), new_data = NULL) #> Warning: Values from `value` are not uniquely identified; output will contain list-cols. #> • Use `values_fn = list` to suppress this warning. #> • Use `values_fn = {summary_fun}` to summarise duplicates. #> • Use the following dplyr code to identify duplicates. #>   {data} |> #>   dplyr::summarise(n = dplyr::n(), .by = c(water, fat, protein, location)) |> #>   dplyr::filter(n > 1L) final_data[1:5, 1:8] #> # A tibble: 5 × 8 #>   water   fat protein nir_01    nir_02    nir_03    nir_04    nir_05    #>   <dbl> <dbl>   <dbl> <list>    <list>    <list>    <list>    <list>    #> 1  60.5  22.5    16.7 <dbl [1]> <dbl [1]> <dbl [1]> <dbl [1]> <dbl [1]> #> 2  46    40.1    13.5 <dbl [1]> <dbl [1]> <dbl [1]> <dbl [1]> <dbl [1]> #> 3  71     8.4    20.5 <dbl [1]> <dbl [1]> <dbl [1]> <dbl [1]> <dbl [1]> #> 4  72.8   5.9    20.7 <dbl [2]> <dbl [2]> <dbl [2]> <dbl [2]> <dbl [2]> #> 5  58.3  25.5    15.5 <dbl [2]> <dbl [2]> <dbl [2]> <dbl [2]> <dbl [2]>"},{"path":"https://jameshwade.github.io/measure/dev/articles/baseline.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Baseline Correction","text":"Use step_measure_savitzky_golay() derivatives baseline correction needs first derivative (differentiation_order = 1) handles constant baseline offsets second derivative (differentiation_order = 2) handles linear baseline trends specialized cases, use subtract_rf_baseline() measure workflow Combine baseline correction normalization (SNV/MSC) best results","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Internal Class System","text":"vignette describes measure’s internal class system. users won’t need interact internals directly, understanding useful ’re: Debugging unexpected behavior Contributing measure Building extensions work measure data","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"motivation","dir":"Articles","previous_headings":"","what":"Motivation","title":"Internal Class System","text":"Early versions measure relied column named .measures store spectral data. worked limitations: Name clashes users .measures column way multiple measure columns Detection relied column names, types Following Issue #16, measure now uses custom S3 classes. enables robust detection via inherits() supports multiple measure columns per dataset (see Multiple Measure Columns ).","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"the-two-classes","dir":"Articles","previous_headings":"","what":"The two classes","title":"Internal Class System","text":"measure uses two-level class hierarchy:","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"measure_tbl","dir":"Articles","previous_headings":"The two classes","what":"measure_tbl","title":"Internal Class System","text":"single measurement - tibble location value columns:","code":"# After preprocessing, each row's .measures element is a measure_tbl rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   prep()  result <- bake(rec, new_data = NULL)  # Extract one measurement one_measurement <- result$.measures[[1]] one_measurement #> <measure_tbl [100 x 2]> #> # A tibble: 100 × 2 #>    location value #>       <int> <dbl> #>  1        1  2.62 #>  2        2  2.62 #>  3        3  2.62 #>  4        4  2.62 #>  5        5  2.62 #>  6        6  2.62 #>  7        7  2.62 #>  8        8  2.62 #>  9        9  2.63 #> 10       10  2.63 #> # ℹ 90 more rows  # Check the class class(one_measurement) #> [1] \"measure_tbl\" \"tbl_df\"      \"tbl\"         \"data.frame\" is_measure_tbl(one_measurement) #> [1] TRUE"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"measure_list","dir":"Articles","previous_headings":"The two classes","what":"measure_list","title":"Internal Class System","text":"list column containing multiple measure_tbl objects - one per row data:","code":"# The .measures column itself is a measure_list class(result$.measures) #> [1] \"measure_list\"  \"vctrs_list_of\" \"vctrs_vctr\"    \"list\" is_measure_list(result$.measures) #> [1] TRUE  # Nice printing in tibbles result #> # A tibble: 215 × 5 #>       id water   fat protein .measures #>    <int> <dbl> <dbl>   <dbl>    <meas> #>  1     1  60.5  22.5    16.7 [100 × 2] #>  2     2  46    40.1    13.5 [100 × 2] #>  3     3  71     8.4    20.5 [100 × 2] #>  4     4  72.8   5.9    20.7 [100 × 2] #>  5     5  58.3  25.5    15.5 [100 × 2] #>  6     6  44    42.7    13.7 [100 × 2] #>  7     7  44    42.7    13.7 [100 × 2] #>  8     8  69.3  10.6    19.3 [100 × 2] #>  9     9  61.4  19.9    17.7 [100 × 2] #> 10    10  61.4  19.9    17.7 [100 × 2] #> # ℹ 205 more rows"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"detecting-measure-columns","dir":"Articles","previous_headings":"","what":"Detecting measure columns","title":"Internal Class System","text":"measure provides helper functions find validate measure columns:","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"is_measure_list-and-is_measure_tbl","dir":"Articles","previous_headings":"Detecting measure columns","what":"is_measure_list() and is_measure_tbl()","title":"Internal Class System","text":"Test object appropriate class:","code":"is_measure_list(result$.measures) #> [1] TRUE is_measure_tbl(result$.measures[[1]]) #> [1] TRUE  # Regular lists and tibbles return FALSE is_measure_list(list()) #> [1] FALSE is_measure_tbl(tibble::tibble(location = 1:5, value = rnorm(5))) #> [1] FALSE"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"find_measure_cols","dir":"Articles","previous_headings":"Detecting measure columns","what":"find_measure_cols()","title":"Internal Class System","text":"Find measure columns data frame:","code":"find_measure_cols(result) #> [1] \".measures\""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"has_measure_col","dir":"Articles","previous_headings":"Detecting measure columns","what":"has_measure_col()","title":"Internal Class System","text":"Check data frame least one measure column, erroring : used internally processing steps validate input.","code":"has_measure_col(result)"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"why-this-matters","dir":"Articles","previous_headings":"","what":"Why this matters","title":"Internal Class System","text":"class-based approach provides several benefits: Robust detection: Steps use inherits(x, \"measure_list\") instead checking column names Nice printing: Tibbles show <meas [100]> instead raw list output Multiple columns: can multiple measure columns per dataset (e.g., UV MS spectra) Validation: classes enforce measurements expected structure","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"for-package-developers","dir":"Articles","previous_headings":"","what":"For package developers","title":"Internal Class System","text":"’re writing functions work measure data: helper functions measure_to_matrix() matrix_to_measure() R/helpers.R convert measure lists matrices bulk operations.","code":"my_function <- function(data) {   # Validate input has measure columns   has_measure_col(data)    # Find measure columns   meas_cols <- find_measure_cols(data)    # Work with the measure_list   for (col in meas_cols) {     measurements <- data[[col]]     # Each element is a measure_tbl with $location and $value   } }"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"multiple-measure-columns","dir":"Articles","previous_headings":"","what":"Multiple Measure Columns","title":"Internal Class System","text":"measure supports multiple measure columns single dataset. useful different types measurements (e.g., UV MS spectra) need separate processing.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"creating-multiple-measure-columns","dir":"Articles","previous_headings":"Multiple Measure Columns","what":"Creating multiple measure columns","title":"Internal Class System","text":"Use col_name parameter input steps:","code":"rec <- recipe(outcome ~ ., data = my_data) |>   step_measure_input_wide(     starts_with(\"uv_\"),     col_name = \".uv_spectrum\"   ) |>   step_measure_input_wide(     starts_with(\"ms_\"),     col_name = \".ms_spectrum\"   )"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"processing-steps","dir":"Articles","previous_headings":"Multiple Measure Columns","what":"Processing steps","title":"Internal Class System","text":"default, processing steps operate measure columns: process specific columns, use measures parameter:","code":"rec <- rec |>   step_measure_snv()  # Applies to both .uv_spectrum and .ms_spectrum rec <- rec |>   step_measure_snv(measures = \".uv_spectrum\")  # Only UV"},{"path":"https://jameshwade.github.io/measure/dev/articles/internals.html","id":"output-steps","dir":"Articles","previous_headings":"Multiple Measure Columns","what":"Output steps","title":"Internal Class System","text":"multiple measure columns exist, output steps require specify column output: don’t specify multiple columns exist, ’ll get helpful error message telling columns available.","code":"rec <- rec |>   step_measure_output_wide(measures = \".uv_spectrum\", prefix = \"uv_\") |>   step_measure_output_wide(measures = \".ms_spectrum\", prefix = \"ms_\")"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with measure","text":"measure package extends tidymodels preprocessing steps designed specifically analytical measurement data. work spectroscopy, chromatography, instrument-generated signals, measure provides familiar recipes-style preprocessing integrates seamlessly tidymodels ecosystem.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"why-measure","dir":"Articles","previous_headings":"Introduction","what":"Why measure?","title":"Getting Started with measure","text":"Analytical data unique preprocessing requirements: Multi-dimensional signals: sample produces many measurements (e.g., absorbance hundreds wavelengths) Specialized transformations: Techniques like Savitzky-Golay derivatives scatter correction standard practice Format flexibility: Data may arrive wide format (one column per wavelength) long format (one row per measurement) measure handles keeping intuitive recipes interface already know. ## measure workflow typical measure workflow three phases: Input step: Convert data measure’s internal format Processing steps: Apply spectral preprocessing (smoothing, derivatives, normalization) Output step: Convert back format suitable modeling Let’s see action real data.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"example-nir-spectroscopy-of-meat-samples","dir":"Articles","previous_headings":"","what":"Example: NIR spectroscopy of meat samples","title":"Getting Started with measure","text":"’ll use meats_long dataset included measure. contains NIR (Near-Infrared) transmittance spectra meat samples, goal predicting water, fat, protein content. data “long” format row represents one measurement one channel one sample. Let’s visualize spectra:","code":"data(meats_long)  # Each sample has 100 spectral channels meats_long #> # A tibble: 21,500 × 6 #>       id water   fat protein channel transmittance #>    <int> <dbl> <dbl>   <dbl>   <int>         <dbl> #>  1     1  60.5  22.5    16.7       1          2.62 #>  2     1  60.5  22.5    16.7       2          2.62 #>  3     1  60.5  22.5    16.7       3          2.62 #>  4     1  60.5  22.5    16.7       4          2.62 #>  5     1  60.5  22.5    16.7       5          2.62 #>  6     1  60.5  22.5    16.7       6          2.62 #>  7     1  60.5  22.5    16.7       7          2.62 #>  8     1  60.5  22.5    16.7       8          2.62 #>  9     1  60.5  22.5    16.7       9          2.63 #> 10     1  60.5  22.5    16.7      10          2.63 #> # ℹ 21,490 more rows meats_long |>   filter(id <= 10) |>   ggplot(aes(x = channel, y = transmittance, group = id, color = factor(id))) +   geom_line(alpha = 0.8) +   labs(     x = \"Channel\",     y = \"Transmittance\",     title = \"Raw NIR Spectra\",     color = \"Sample ID\"   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"creating-a-recipe","dir":"Articles","previous_headings":"Example: NIR spectroscopy of meat samples","what":"Creating a recipe","title":"Getting Started with measure","text":"start creating recipe specifies outcome variables predictors:","code":"rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   # Mark 'id' as an identifier, not a predictor   update_role(id, new_role = \"id\")  rec #>  #> ── Recipe ────────────────────────────────────────────────────────────────────── #>  #> ── Inputs #> Number of variables by role #> outcome:   3 #> predictor: 2 #> id:        1"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"step-1-input-the-measurements","dir":"Articles","previous_headings":"Example: NIR spectroscopy of meat samples","what":"Step 1: Input the measurements","title":"Getting Started with measure","text":"Since data long format, use step_measure_input_long(). converts transmittance values (indexed channel) measure’s internal format: prepping baking, ’ll see original transmittance channel columns replaced .measures column containing nested tibbles:","code":"rec <- rec |>   step_measure_input_long(transmittance, location = vars(channel))  rec #>  #> ── Recipe ────────────────────────────────────────────────────────────────────── #>  #> ── Inputs #> Number of variables by role #> outcome:   3 #> predictor: 2 #> id:        1 #>  #> ── Operations #> • Collate long analytical measurements: transmittance rec_prepped <- prep(rec) internal_format <- bake(rec_prepped, new_data = NULL)  # The data now has a .measures list-column internal_format #> # A tibble: 215 × 5 #>       id water   fat protein .measures #>    <int> <dbl> <dbl>   <dbl>    <meas> #>  1     1  60.5  22.5    16.7 [100 × 2] #>  2     2  46    40.1    13.5 [100 × 2] #>  3     3  71     8.4    20.5 [100 × 2] #>  4     4  72.8   5.9    20.7 [100 × 2] #>  5     5  58.3  25.5    15.5 [100 × 2] #>  6     6  44    42.7    13.7 [100 × 2] #>  7     7  44    42.7    13.7 [100 × 2] #>  8     8  69.3  10.6    19.3 [100 × 2] #>  9     9  61.4  19.9    17.7 [100 × 2] #> 10    10  61.4  19.9    17.7 [100 × 2] #> # ℹ 205 more rows  # Each element contains location and value internal_format$.measures[[1]] #> <measure_tbl [100 x 2]> #> # A tibble: 100 × 2 #>    location value #>       <int> <dbl> #>  1        1  2.62 #>  2        2  2.62 #>  3        3  2.62 #>  4        4  2.62 #>  5        5  2.62 #>  6        6  2.62 #>  7        7  2.62 #>  8        8  2.62 #>  9        9  2.63 #> 10       10  2.63 #> # ℹ 90 more rows"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"step-2-apply-preprocessing","dir":"Articles","previous_headings":"Example: NIR spectroscopy of meat samples","what":"Step 2: Apply preprocessing","title":"Getting Started with measure","text":"Now can add spectral preprocessing steps. operate internal .measures column: Let’s see transforms spectra:","code":"rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   # Savitzky-Golay first derivative for baseline removal   step_measure_savitzky_golay(     window_side = 5,     differentiation_order = 1   ) |>   # Standard Normal Variate for scatter correction   step_measure_snv()  rec #>  #> ── Recipe ────────────────────────────────────────────────────────────────────── #>  #> ── Inputs #> Number of variables by role #> outcome:   3 #> predictor: 2 #> id:        1 #>  #> ── Operations #> • Collate long analytical measurements: transmittance #> Savitzky-Golay preprocessing on  #> SNV transformation on processed <- bake(prep(rec), new_data = NULL)  # Unnest for plotting plot_data <- processed |>   filter(row_number() <= 10) |>   mutate(sample_id = row_number()) |>   unnest(.measures)  ggplot(plot_data, aes(x = location, y = value, group = sample_id, color = factor(sample_id))) +   geom_line(alpha = 0.8) +   labs(     x = \"Channel\",     y = \"Preprocessed Signal\",     title = \"After Savitzky-Golay + SNV\",     subtitle = \"First derivative removes baseline; SNV normalizes scatter\",     color = \"Sample\"   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"step-3-output-for-modeling","dir":"Articles","previous_headings":"Example: NIR spectroscopy of meat samples","what":"Step 3: Output for modeling","title":"Getting Started with measure","text":"modeling workflows, ’ll want data wide format (one column per spectral feature):","code":"rec_full <- recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   step_measure_snv() |>   step_measure_output_wide(prefix = \"nir_\")  modeling_data <- bake(prep(rec_full), new_data = NULL)  # Ready for modeling! modeling_data[1:5, 1:10] #> # A tibble: 5 × 10 #>      id water   fat protein  nir_01  nir_02  nir_03  nir_04  nir_05  nir_06 #>   <int> <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #> 1     1  60.5  22.5    16.7 -0.126  -0.110  -0.0928 -0.0745 -0.0553 -0.0346 #> 2     2  46    40.1    13.5  0.0184  0.0381  0.0601  0.0841  0.110   0.137  #> 3     3  71     8.4    20.5  0.105   0.114   0.125   0.136   0.148   0.159  #> 4     4  72.8   5.9    20.7  0.0716  0.0786  0.0871  0.0974  0.108   0.119  #> 5     5  58.3  25.5    15.5 -0.132  -0.118  -0.101  -0.0817 -0.0608 -0.0385"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"working-with-wide-format-data","dir":"Articles","previous_headings":"","what":"Working with wide-format data","title":"Getting Started with measure","text":"data starts wide format (measurements columns), use step_measure_input_wide() instead. ’s example using data modeldata:","code":"library(modeldata) data(meats)  # This data has x_001, x_002, ... columns for spectral channels head(meats[, 1:8]) #> # A tibble: 6 × 8 #>   x_001 x_002 x_003 x_004 x_005 x_006 x_007 x_008 #>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> #> 1  2.62  2.62  2.62  2.62  2.62  2.62  2.62  2.62 #> 2  2.83  2.84  2.84  2.85  2.85  2.86  2.86  2.87 #> 3  2.58  2.58  2.59  2.59  2.59  2.59  2.59  2.60 #> 4  2.82  2.82  2.83  2.83  2.83  2.83  2.83  2.84 #> 5  2.79  2.79  2.79  2.79  2.80  2.80  2.80  2.80 #> 6  3.01  3.02  3.02  3.03  3.03  3.04  3.04  3.05  # Create location values (optional - defaults to 1, 2, 3, ...) wavelengths <- seq(850, 1050, length.out = 100)  rec_wide <- recipe(water + fat + protein ~ ., data = meats) |>   step_measure_input_wide(     starts_with(\"x_\"),     location_values = wavelengths   ) |>   step_measure_snv() |>   step_measure_output_wide(prefix = \"spec_\")  bake(prep(rec_wide), new_data = NULL)[1:5, 1:8] #> Warning: Values from `value` are not uniquely identified; output will contain list-cols. #> • Use `values_fn = list` to suppress this warning. #> • Use `values_fn = {summary_fun}` to summarise duplicates. #> • Use the following dplyr code to identify duplicates. #>   {data} |> #>   dplyr::summarise(n = dplyr::n(), .by = c(water, fat, protein, location)) |> #>   dplyr::filter(n > 1L) #> # A tibble: 5 × 8 #>   water   fat protein spec_0850.0000 spec_0852.0202 spec_0854.0404 #>   <dbl> <dbl>   <dbl> <list>         <list>         <list>         #> 1  60.5  22.5    16.7 <dbl [1]>      <dbl [1]>      <dbl [1]>      #> 2  46    40.1    13.5 <dbl [1]>      <dbl [1]>      <dbl [1]>      #> 3  71     8.4    20.5 <dbl [1]>      <dbl [1]>      <dbl [1]>      #> 4  72.8   5.9    20.7 <dbl [2]>      <dbl [2]>      <dbl [2]>      #> 5  58.3  25.5    15.5 <dbl [2]>      <dbl [2]>      <dbl [2]>      #> # ℹ 2 more variables: spec_0856.0606 <list>, spec_0858.0808 <list>"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"applying-recipes-to-new-data","dir":"Articles","previous_headings":"","what":"Applying recipes to new data","title":"Getting Started with measure","text":"Like recipe, prep training data, bake new data:","code":"# Split the data set.seed(123) train_idx <- sample(nrow(meats), 180) train_data <- meats[train_idx, ] test_data <- meats[-train_idx, ]  # Prep on training data rec <- recipe(water + fat + protein ~ ., data = train_data) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 1) |>   step_measure_snv() |>   step_measure_output_wide(prefix = \"nir_\")  rec_prepped <- prep(rec, training = train_data) #> Warning: Values from `value` are not uniquely identified; output will contain list-cols. #> • Use `values_fn = list` to suppress this warning. #> • Use `values_fn = {summary_fun}` to summarise duplicates. #> • Use the following dplyr code to identify duplicates. #>   {data} |> #>   dplyr::summarise(n = dplyr::n(), .by = c(water, fat, protein, location)) |> #>   dplyr::filter(n > 1L)  # Bake on both train_processed <- bake(rec_prepped, new_data = NULL) test_processed <- bake(rec_prepped, new_data = test_data) #> Warning: Values from `value` are not uniquely identified; output will contain list-cols. #> • Use `values_fn = list` to suppress this warning. #> • Use `values_fn = {summary_fun}` to summarise duplicates. #> • Use the following dplyr code to identify duplicates. #>   {data} |> #>   dplyr::summarise(n = dplyr::n(), .by = c(water, fat, protein, location)) |> #>   dplyr::filter(n > 1L)  cat(\"Training samples:\", nrow(train_processed), \"\\n\") #> Training samples: 153 cat(\"Test samples:\", nrow(test_processed), \"\\n\") #> Test samples: 32"},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"integration-with-tidymodels","dir":"Articles","previous_headings":"","what":"Integration with tidymodels","title":"Getting Started with measure","text":"measure recipes work seamlessly broader tidymodels ecosystem. See vignette(\"recipes\") complete examples including: Bundling preprocessing models using workflows Cross-validation measure recipes Hyperparameter tuning preprocessing steps Comparing preprocessing strategies","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/measure.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Getting Started with measure","text":"See vignette(\"preprocessing\") detailed guide preprocessing technique Explore hyperparameter tuning tune - measure’s Savitzky-Golay step tunable! Check function reference available steps","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Preprocessing Techniques","text":"Spectral preprocessing essential building accurate chemometric models. Raw spectra often contain unwanted variation physical effects (scatter, baseline drift) obscure chemical information ’re trying model. vignette covers preprocessing technique available measure use .","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"why-preprocess-spectra","dir":"Articles","previous_headings":"","what":"Why preprocess spectra?","title":"Preprocessing Techniques","text":"diving specific techniques, let’s understand ’re dealing . raw NIR spectra meats dataset:  Notice spectra shifted vertically relative ? offset isn’t due chemical differences - ’s caused physical factors like particle size, path length, light scatter. preprocessing goal remove unwanted effects preserving chemical information.","code":"rec_raw <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths)  raw_data <- get_internal(rec_raw)  plot_spectra(raw_data, \"Raw NIR Spectra\", \"Note the vertical offset differences between samples\")"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"what-it-does","dir":"Articles","previous_headings":"Savitzky-Golay Filtering","what":"What it does","title":"Preprocessing Techniques","text":"Savitzky-Golay filter performs polynomial smoothing can compute derivatives. fits polynomial sliding window points, using polynomial’s value (derivative) center point output.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"when-to-use-it","dir":"Articles","previous_headings":"Savitzky-Golay Filtering","what":"When to use it","title":"Preprocessing Techniques","text":"Smoothing (order = 0): Reduce random noise preserving peak shapes First derivative (order = 1): Remove constant baseline offsets, enhance peak differences Second derivative (order = 2): Remove linear baseline trends, enhance peak resolution","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"parameters","dir":"Articles","previous_headings":"Savitzky-Golay Filtering","what":"Parameters","title":"Preprocessing Techniques","text":"window_side: Number points side center point (total window = 2 * window_side + 1) differentiation_order: 0 smoothing, 1 first derivative, 2 second derivative degree: Polynomial degree (defaults differentiation_order + 1)","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"examples","dir":"Articles","previous_headings":"Savitzky-Golay Filtering","what":"Examples","title":"Preprocessing Techniques","text":"","code":"# Just smoothing rec_smooth <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 0)  # First derivative rec_d1 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1)  # Second derivative rec_d2 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 2) library(patchwork)  p1 <- plot_spectra(raw_data, \"Raw\") p2 <- plot_spectra(get_internal(rec_smooth), \"Smoothed (window = 15)\") p3 <- plot_spectra(get_internal(rec_d1), \"1st Derivative\", \"Baseline offset removed\") p4 <- plot_spectra(get_internal(rec_d2), \"2nd Derivative\", \"Linear baseline removed\")  (p1 + p2) / (p3 + p4)"},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"choosing-window-size","dir":"Articles","previous_headings":"Savitzky-Golay Filtering","what":"Choosing window size","title":"Preprocessing Techniques","text":"window size bias-variance trade-: - Smaller window: Less smoothing, preserves sharp features, noise - Larger window: smoothing, may blur sharp peaks, less noise good starting point window spans narrowest feature want preserve.","code":"windows <- c(3, 7, 15)  window_data <- lapply(windows, function(w) {   rec <- recipe(water ~ ., data = meats) |>     step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>     step_measure_savitzky_golay(window_side = w, differentiation_order = 1)    get_internal(rec) |>     filter(sample_id == 1) |>     mutate(window = paste0(\"window_side = \", w)) }) |>   bind_rows()  ggplot(window_data, aes(x = location, y = value, color = window)) +   geom_line() +   labs(     x = \"Wavelength\",     y = \"Signal\",     title = \"Effect of Window Size on First Derivative\",     color = NULL   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"tuning-with-dials","dir":"Articles","previous_headings":"Savitzky-Golay Filtering","what":"Tuning with dials","title":"Preprocessing Techniques","text":"Savitzky-Golay step tunable! means can use tune() find optimal parameters:","code":"library(tune) library(workflows)  rec_tunable <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(     window_side = tune(),     differentiation_order = tune()   ) |>   step_measure_output_wide()  # The tunable parameters are: tunable(rec_tunable)"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"what-it-does-1","dir":"Articles","previous_headings":"Standard Normal Variate (SNV)","what":"What it does","title":"Preprocessing Techniques","text":"SNV normalizes spectrum independently centering scaling: SNV(x)=x−x‾sxSNV(x) = \\frac{x - \\bar{x}}{s_x} x‾\\bar{x} spectrum’s mean sxs_x standard deviation.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"when-to-use-it-1","dir":"Articles","previous_headings":"Standard Normal Variate (SNV)","what":"When to use it","title":"Preprocessing Techniques","text":"Remove multiplicative scatter effects Correct path length variations Normalize spectra similar magnitude SNV particularly effective diffuse reflectance spectra particle size causes scatter variations.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"example","dir":"Articles","previous_headings":"Standard Normal Variate (SNV)","what":"Example","title":"Preprocessing Techniques","text":"","code":"rec_snv <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>   step_measure_snv()  snv_data <- get_internal(rec_snv) plot_spectra(snv_data, \"After SNV Normalization\", \"Each spectrum has mean = 0 and sd = 1\")"},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"combining-with-derivatives","dir":"Articles","previous_headings":"Standard Normal Variate (SNV)","what":"Combining with derivatives","title":"Preprocessing Techniques","text":"SNV often combined Savitzky-Golay derivatives. order matters:","code":"# Derivative then SNV (more common) rec_d1_snv <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   step_measure_snv()  plot_spectra(get_internal(rec_d1_snv), \"1st Derivative + SNV\",              \"Combined baseline removal and scatter correction\")"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"what-it-does-2","dir":"Articles","previous_headings":"Multiplicative Scatter Correction (MSC)","what":"What it does","title":"Preprocessing Techniques","text":"MSC aligns spectrum reference spectrum (typically mean training spectra) correcting additive multiplicative effects: Fit spectrum xix_i reference xrx_r: xi=mi⋅xr+aix_i = m_i \\cdot x_r + a_i Correct: MSC(xi)=xi−aimiMSC(x_i) = \\frac{x_i - a_i}{m_i}","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"when-to-use-it-2","dir":"Articles","previous_headings":"Multiplicative Scatter Correction (MSC)","what":"When to use it","title":"Preprocessing Techniques","text":"Similar applications SNV good reference spectrum Often slightly better SNV scatter correction","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"how-it-differs-from-snv","dir":"Articles","previous_headings":"Multiplicative Scatter Correction (MSC)","what":"How it differs from SNV","title":"Preprocessing Techniques","text":"SNV: spectrum normalized independently (reference needed) MSC: spectra aligned common reference (learns reference prep) means MSC trained step - learns reference spectrum training data applies reference new data.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"example-1","dir":"Articles","previous_headings":"Multiplicative Scatter Correction (MSC)","what":"Example","title":"Preprocessing Techniques","text":"","code":"rec_msc <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\"), location_values = wavelengths) |>   step_measure_msc()  msc_data <- get_internal(rec_msc) plot_spectra(msc_data, \"After MSC\", \"Spectra aligned to mean reference\")"},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"comparing-snv-and-msc","dir":"Articles","previous_headings":"Multiplicative Scatter Correction (MSC)","what":"Comparing SNV and MSC","title":"Preprocessing Techniques","text":"methods produce similar results dataset. practice, try compare model performance.","code":"p_snv <- plot_spectra(get_internal(rec_snv), \"SNV\") p_msc <- plot_spectra(get_internal(rec_msc), \"MSC\")  p_snv / p_msc"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"common-combinations","dir":"Articles","previous_headings":"Preprocessing pipelines","what":"Common combinations","title":"Preprocessing Techniques","text":"commonly used preprocessing pipelines:","code":"# Pipeline 1: Basic scatter correction pipe1 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_snv() |>   step_measure_output_wide()  # Pipeline 2: Derivative + normalization pipe2 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   step_measure_snv() |>   step_measure_output_wide()  # Pipeline 3: Second derivative (often enough on its own) pipe3 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 2) |>   step_measure_output_wide()  # Pipeline 4: MSC + smoothing pipe4 <- recipe(water ~ ., data = meats) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_msc() |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 0) |>   step_measure_output_wide()"},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"order-of-operations","dir":"Articles","previous_headings":"Preprocessing pipelines","what":"Order of operations","title":"Preprocessing Techniques","text":"order preprocessing steps matters. General guidelines: Derivatives normalization: Apply Savitzky-Golay derivatives first, SNV/MSC Smoothing scatter correction: using smoothing (derivatives), apply MSC/SNV Keep simple: Often, single well-chosen step outperforms complex pipelines","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"tips-for-choosing-preprocessing","dir":"Articles","previous_headings":"","what":"Tips for choosing preprocessing","title":"Preprocessing Techniques","text":"Start simple: Try SNV first derivative alone complex pipelines Visualize: Always plot preprocessed spectra check artifacts Validate: Use cross-validation compare preprocessing strategies Domain knowledge: Consider physics measurement system Tune: Use tune() optimize Savitzky-Golay parameters","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/preprocessing.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Preprocessing Techniques","text":"Savitzky, ., Golay, M. J. E. (1964). Smoothing Differentiation Data Simplified Least Squares Procedures. Analytical Chemistry, 36(8), 1627-1639. Barnes, R. J., Dhanoa, M. S., Lister, S. J. (1989). Standard Normal Variate Transformation De-Trending Near-Infrared Diffuse Reflectance Spectra. Applied Spectroscopy, 43(5), 772-777. Geladi, P., MacDougall, D., Martens, H. (1985). Linearization Scatter-Correction Near-Infrared Reflectance Spectra Meat. Applied Spectroscopy, 39(3), 491-500.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Integrating with tidymodels","text":"One measure’s key design goals seamless integration tidymodels ecosystem. vignette shows use measure preprocessing within complete modeling workflows, including: Bundling preprocessing models using workflows Cross-validation measure recipes Hyperparameter tuning preprocessing steps Comparing preprocessing strategies","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"setup-the-meats-dataset","dir":"Articles","previous_headings":"","what":"Setup: The meats dataset","title":"Integrating with tidymodels","text":"’ll use NIR spectroscopy dataset modeldata predict water content meat samples. ’ll focus just predicting water keep example simple.","code":"data(meats)  # Keep only water as outcome and spectral columns meats_water <- meats |>   select(water, starts_with(\"x_\"))  # Create train/test split split <- initial_split(meats_water, prop = 0.75) train <- training(split) test <- testing(split)  cat(\"Training samples:\", nrow(train), \"\\n\") #> Training samples: 161 cat(\"Test samples:\", nrow(test), \"\\n\") #> Test samples: 54"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"basic-workflow","dir":"Articles","previous_headings":"","what":"Basic workflow","title":"Integrating with tidymodels","text":"simplest way use measure tidymodels workflow bundles preprocessing modeling:","code":"# Define preprocessing recipe rec <- recipe(water ~ ., data = train) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   step_measure_snv() |>   step_measure_output_wide()  # Define model - simple linear regression # (For real applications, use regularization like glmnet or PLS) lm_spec <- linear_reg() |>   set_engine(\"lm\")  # Create workflow wf <- workflow() |>   add_recipe(rec) |>   add_model(lm_spec)  wf #> ══ Workflow ════════════════════════════════════════════════════════════════════ #> Preprocessor: Recipe #> Model: linear_reg() #>  #> ── Preprocessor ──────────────────────────────────────────────────────────────── #> 4 Recipe Steps #>  #> • step_measure_input_wide() #> • step_measure_savitzky_golay() #> • step_measure_snv() #> • step_measure_output_wide() #>  #> ── Model ─────────────────────────────────────────────────────────────────────── #> Linear Regression Model Specification (regression) #>  #> Computational engine: lm"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"fit-and-evaluate","dir":"Articles","previous_headings":"Basic workflow","what":"Fit and evaluate","title":"Integrating with tidymodels","text":"","code":"# Fit the workflow wf_fit <- fit(wf, data = train)  # Predict on test data predictions <- predict(wf_fit, test) |>   bind_cols(test |> select(water))  # Evaluate metrics(predictions, truth = water, estimate = .pred)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"cross-validation","dir":"Articles","previous_headings":"","what":"Cross-validation","title":"Integrating with tidymodels","text":"Cross-validation straightforward workflows:","code":"# Create folds folds <- vfold_cv(train, v = 5)  # Fit resamples cv_results <- fit_resamples(wf, resamples = folds)  # Collect metrics collect_metrics(cv_results)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"tuning-preprocessing-parameters","dir":"Articles","previous_headings":"","what":"Tuning preprocessing parameters","title":"Integrating with tidymodels","text":"measure’s Savitzky-Golay step tunable parameters. Let’s find optimal window size differentiation order:","code":"# Create a tunable recipe rec_tune <- recipe(water ~ ., data = train) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(     window_side = tune(),     differentiation_order = tune()   ) |>   step_measure_snv() |>   step_measure_output_wide()  # Create tunable workflow wf_tune <- workflow() |>   add_recipe(rec_tune) |>   add_model(lm_spec)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"define-the-parameter-grid","dir":"Articles","previous_headings":"Tuning preprocessing parameters","what":"Define the parameter grid","title":"Integrating with tidymodels","text":"","code":"# Create a grid grid <- grid_regular(   window_side(range = c(3L, 11L)),   differentiation_order(range = c(0L, 2L)),   levels = c(5, 3) )  grid"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"run-the-tuning","dir":"Articles","previous_headings":"Tuning preprocessing parameters","what":"Run the tuning","title":"Integrating with tidymodels","text":"","code":"tune_results <- tune_grid(   wf_tune,   resamples = folds,   grid = grid )  # Show best results show_best(tune_results, metric = \"rmse\", n = 5)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"visualize-tuning-results","dir":"Articles","previous_headings":"Tuning preprocessing parameters","what":"Visualize tuning results","title":"Integrating with tidymodels","text":"","code":"autoplot(tune_results)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"finalize-the-workflow","dir":"Articles","previous_headings":"Tuning preprocessing parameters","what":"Finalize the workflow","title":"Integrating with tidymodels","text":"","code":"# Select best parameters best_params <- select_best(tune_results, metric = \"rmse\") best_params  # Finalize workflow final_wf <- finalize_workflow(wf_tune, best_params)  # Fit on full training data and evaluate on test final_fit <- last_fit(final_wf, split)  collect_metrics(final_fit)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"comparing-preprocessing-strategies","dir":"Articles","previous_headings":"","what":"Comparing preprocessing strategies","title":"Integrating with tidymodels","text":"common workflow comparing different preprocessing approaches. ’s set fair comparison:","code":"# Strategy 1: SNV only rec_snv <- recipe(water ~ ., data = train) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_snv() |>   step_measure_output_wide()  # Strategy 2: First derivative + SNV rec_d1_snv <- recipe(water ~ ., data = train) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 1) |>   step_measure_snv() |>   step_measure_output_wide()  # Strategy 3: MSC rec_msc <- recipe(water ~ ., data = train) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_msc() |>   step_measure_output_wide()  # Strategy 4: Second derivative only rec_d2 <- recipe(water ~ ., data = train) |>   step_measure_input_wide(starts_with(\"x_\")) |>   step_measure_savitzky_golay(window_side = 7, differentiation_order = 2) |>   step_measure_output_wide()  # Create workflow set wf_set <- workflow_set(   preproc = list(     snv = rec_snv,     d1_snv = rec_d1_snv,     msc = rec_msc,     d2 = rec_d2   ),   models = list(lm = lm_spec) )  wf_set"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"evaluate-all-strategies","dir":"Articles","previous_headings":"Comparing preprocessing strategies","what":"Evaluate all strategies","title":"Integrating with tidymodels","text":"","code":"# Fit all workflows with cross-validation comparison <- workflow_map(   wf_set,   fn = \"fit_resamples\",   resamples = folds )  # Rank by performance rank_results(comparison, rank_metric = \"rmse\")"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"visualize-comparison","dir":"Articles","previous_headings":"Comparing preprocessing strategies","what":"Visualize comparison","title":"Integrating with tidymodels","text":"","code":"autoplot(comparison) +   labs(title = \"Preprocessing Strategy Comparison\")"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"working-with-workflows-and-new-data","dir":"Articles","previous_headings":"","what":"Working with workflows and new data","title":"Integrating with tidymodels","text":"’ve selected final workflow, ’s use predictions new data:","code":"# Use the finalized workflow from tuning final_trained <- fit(final_wf, train)  # Predict on new data new_predictions <- predict(final_trained, test)  # Or use augment for predictions with original data augment(final_trained, test) |>   select(water, .pred) |>   head()"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"high-dimensional-data","dir":"Articles","previous_headings":"Tips for spectral modeling","what":"High-dimensional data","title":"Integrating with tidymodels","text":"Spectral data typically high-dimensional (many features, fewer samples). Consider: Regularization: Use ridge elastic net regression (linear_reg(penalty = tune(), mixture = tune())) PLS regression: Use pls() parsnip mixOmics engine Feature selection: Consider variable importance initial modeling","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"memory-considerations","dir":"Articles","previous_headings":"Tips for spectral modeling","what":"Memory considerations","title":"Integrating with tidymodels","text":"large spectral datasets: internal .measures format memory-efficient Consider processing batches memory limited Use step_measure_output_wide() needed modeling","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"reproducibility","dir":"Articles","previous_headings":"Tips for spectral modeling","what":"Reproducibility","title":"Integrating with tidymodels","text":"Always set seed cross-validation tuning:","code":"set.seed(123) folds <- vfold_cv(train, v = 10)"},{"path":"https://jameshwade.github.io/measure/dev/articles/recipes.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Integrating with tidymodels","text":"measure integrates naturally tidymodels: - Use workflow() bundle preprocessing modeling - Cross-validate fit_resamples() vfold_cv() - Tune Savitzky-Golay parameters tune_grid() - Compare strategies workflow_set() recipes paradigm means preprocessing applied consistently training data, cross-validation folds, new predictions - eliminating common source data leakage chemometric modeling.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Case Study: Bioreactor Glucose Prediction","text":"vignette demonstrates complete chemometric modeling workflow using measure. ’ll predict glucose concentration bioreactors using Raman spectroscopy data.","code":""},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"the-dataset","dir":"Articles","previous_headings":"","what":"The dataset","title":"Case Study: Bioreactor Glucose Prediction","text":"glucose_bioreactors dataset contains Raman spectra bioreactor experiments described Kuhn Johnson’s Feature Engineering Selection (2020). dataset : - 2,651 spectral channels (Raman wavenumbers) - glucose: target variable predict - day: sampling day (1-14) - batch_id batch_sample: reactor identifiers","code":"data(glucose_bioreactors)  # Small-scale bioreactors (15 reactors, 14 days) dim(bioreactors_small) #> [1]  210 2655  # Large-scale bioreactors (3 reactors, 14 days) dim(bioreactors_large) #> [1]   42 2655"},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"exploratory-visualization","dir":"Articles","previous_headings":"","what":"Exploratory visualization","title":"Case Study: Bioreactor Glucose Prediction","text":"Let’s visualize spectra small-scale reactors:","code":"# Get spectral column names (numeric wavenumbers) spec_cols <- names(bioreactors_small)[sapply(names(bioreactors_small), function(x) !is.na(suppressWarnings(as.numeric(x))))]  # Convert a few samples to long format for plotting viz_data <- bioreactors_small |>   slice(1:10) |>   mutate(sample_id = row_number()) |>   select(sample_id, glucose, all_of(spec_cols[1:500])) |>  # First 500 channels   pivot_longer(     cols = -c(sample_id, glucose),     names_to = \"wavenumber\",     values_to = \"intensity\"   ) |>   mutate(wavenumber = as.numeric(wavenumber))  ggplot(viz_data, aes(x = wavenumber, y = intensity, group = sample_id, color = glucose)) +   geom_line(alpha = 0.7) +   scale_color_viridis_c() +   labs(     x = \"Wavenumber\",     y = \"Intensity\",     title = \"Raman Spectra from Small-Scale Bioreactors\",     subtitle = \"Color indicates glucose concentration\",     color = \"Glucose\"   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"building-a-preprocessing-recipe","dir":"Articles","previous_headings":"","what":"Building a preprocessing recipe","title":"Case Study: Bioreactor Glucose Prediction","text":"Raman spectroscopy, typical preprocessing pipeline includes: Smoothing reduce noise Baseline correction (via derivatives) Normalization instrument variations","code":"# Use first 500 spectral columns for faster example spec_cols_subset <- spec_cols[1:500] wavenumbers <- as.numeric(spec_cols_subset)  # Prepare training data train_data <- bioreactors_small |>   select(glucose, day, batch_id, all_of(spec_cols_subset))  # Create preprocessing recipe rec <- recipe(glucose ~ ., data = train_data) |>   # Don't use day and batch_id as predictors   update_role(day, batch_id, new_role = \"id\") |>   # Convert wide spectral columns to internal format   step_measure_input_wide(     all_of(spec_cols_subset),     location_values = wavenumbers   ) |>   # Savitzky-Golay smoothing + first derivative   step_measure_savitzky_golay(     window_side = 7,     differentiation_order = 1   ) |>   # Standard Normal Variate normalization   step_measure_snv() |>   # Convert back to wide format   step_measure_output_wide(prefix = \"raman_\")  rec #>  #> ── Recipe ────────────────────────────────────────────────────────────────────── #>  #> ── Inputs #> Number of variables by role #> outcome:     1 #> predictor: 500 #> id:          2 #>  #> ── Operations #> • Collate wide analytical measurements: all_of(spec_cols_subset) #> Savitzky-Golay preprocessing on  #> SNV transformation on #> • Restructure analytical measurements to wide format: \"<internal data>\""},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"preparing-the-data","dir":"Articles","previous_headings":"","what":"Preparing the data","title":"Case Study: Bioreactor Glucose Prediction","text":"preprocessed data fewer columns : - day batch_id columns preserved ID columns - 500 spectral columns transformed renamed prefix raman_","code":"# Prep the recipe (learns parameters from training data) rec_prepped <- prep(rec)  # Bake to get preprocessed data train_processed <- bake(rec_prepped, new_data = NULL)  # Check dimensions dim(train_processed) #> [1] 210 489"},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"visualize-preprocessed-spectra","dir":"Articles","previous_headings":"","what":"Visualize preprocessed spectra","title":"Case Study: Bioreactor Glucose Prediction","text":"","code":"# Get preprocessed spectral columns proc_cols <- names(train_processed)[grepl(\"^raman_\", names(train_processed))]  proc_viz <- train_processed |>   slice(1:10) |>   mutate(sample_id = row_number()) |>   select(sample_id, glucose, all_of(proc_cols)) |>   pivot_longer(     cols = starts_with(\"raman_\"),     names_to = \"feature\",     values_to = \"value\"   ) |>   mutate(wavenumber = as.numeric(gsub(\"raman_\", \"\", feature)))  ggplot(proc_viz, aes(x = wavenumber, y = value, group = sample_id, color = glucose)) +   geom_line(alpha = 0.7) +   scale_color_viridis_c() +   labs(     x = \"Wavenumber\",     y = \"Preprocessed Intensity\",     title = \"Preprocessed Raman Spectra\",     subtitle = \"After SG derivative + SNV normalization\",     color = \"Glucose\"   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"fitting-a-model","dir":"Articles","previous_headings":"","what":"Fitting a model","title":"Case Study: Bioreactor Glucose Prediction","text":"Now can fit model predict glucose:","code":"library(parsnip)  # Simple linear model (PLS would be better for real applications) lm_spec <- linear_reg() |>   set_engine(\"lm\")  # Fit model model <- lm_spec |>   fit(glucose ~ ., data = train_processed |> select(-day, -batch_id))  # Training performance train_preds <- predict(model, train_processed) |>   bind_cols(train_processed |> select(glucose))  train_preds |>   summarize(     rmse = sqrt(mean((glucose - .pred)^2)),     r_squared = cor(glucose, .pred)^2   ) #> # A tibble: 1 × 2 #>       rmse r_squared #>      <dbl>     <dbl> #> 1 1.76e-12         1"},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"applying-to-new-data","dir":"Articles","previous_headings":"","what":"Applying to new data","title":"Case Study: Bioreactor Glucose Prediction","text":"key advantage recipes framework consistent preprocessing new data:","code":"# Prepare test data from large-scale bioreactors test_data <- bioreactors_large |>   select(glucose, day, batch_id, all_of(spec_cols_subset))  # Apply the same preprocessing test_processed <- bake(rec_prepped, new_data = test_data)  # Predict test_preds <- predict(model, test_processed) |>   bind_cols(test_processed |> select(glucose, batch_id, day)) #> Warning in predict.lm(object = object$fit, newdata = new_data, type = #> \"response\", : prediction from rank-deficient fit; consider predict(., #> rankdeficient=\"NA\")  # Plot predictions vs actual ggplot(test_preds, aes(x = glucose, y = .pred, color = batch_id)) +   geom_point(alpha = 0.7) +   geom_abline(slope = 1, intercept = 0, linetype = \"dashed\") +   labs(     x = \"Actual Glucose\",     y = \"Predicted Glucose\",     title = \"Model Performance on Large-Scale Bioreactors\",     color = \"Reactor\"   ) +   theme_minimal()"},{"path":"https://jameshwade.github.io/measure/dev/articles/sec-analysis-example.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Case Study: Bioreactor Glucose Prediction","text":"case study demonstrated: Loading exploring spectral data bioreactors Building preprocessing recipe measure steps Fitting model preprocessed training data Applying consistent preprocessing new data Key takeaways: recipe framework ensures identical preprocessing training test data step_measure_input_wide() handles conversion many spectral columns Processing steps like Savitzky-Golay SNV remove unwanted variation step_measure_output_wide() produces modeling-ready data real applications, consider: Using PLS ridge regression high-dimensional spectral data Tuning preprocessing parameters cross-validation Validating truly independent test sets","code":""},{"path":"https://jameshwade.github.io/measure/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"James Wade. Author, maintainer.","code":""},{"path":"https://jameshwade.github.io/measure/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wade J (2025). measure: Recipes-style Interface Tidymodels Analytical Measurements. R package version 0.0.1.9000, https://jameshwade.github.io/measure.","code":"@Manual{,   title = {measure: A Recipes-style Interface to Tidymodels for Analytical Measurements},   author = {James Wade},   year = {2025},   note = {R package version 0.0.1.9000},   url = {https://jameshwade.github.io/measure}, }"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"measure extends tidymodels preprocessing steps analytical measurement data spectroscopy, chromatography, instrument-generated signals. provides recipes-style interface common spectral preprocessing techniques. measure helps : Convert measurement data wide long formats internal representation Preprocess spectra using techniques like smoothing, derivatives, normalization Transform data back wide long format modeling visualization","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"can install development version measure GitHub:","code":"# install.packages(\"pak\") pak::pak(\"JamesHWade/measure\")"},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"measure workflow follows familiar recipes pattern: define recipe, add steps, prep, bake.","code":"library(measure) library(recipes) library(ggplot2)  # NIR spectroscopy data for predicting meat composition data(meats_long) head(meats_long) #> # A tibble: 6 × 6 #>      id water   fat protein channel transmittance #>   <int> <dbl> <dbl>   <dbl>   <int>         <dbl> #> 1     1  60.5  22.5    16.7       1          2.62 #> 2     1  60.5  22.5    16.7       2          2.62 #> 3     1  60.5  22.5    16.7       3          2.62 #> 4     1  60.5  22.5    16.7       4          2.62 #> 5     1  60.5  22.5    16.7       5          2.62 #> 6     1  60.5  22.5    16.7       6          2.62"},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"building-a-preprocessing-recipe","dir":"","previous_headings":"Usage","what":"Building a preprocessing recipe","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"","code":"rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   # Assign sample ID role (not used as predictor)   update_role(id, new_role = \"id\") |>   # Convert long-format measurements to internal representation   step_measure_input_long(transmittance, location = vars(channel)) |>   # Apply Savitzky-Golay smoothing with first derivative   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   # Standard Normal Variate normalization   step_measure_snv() |>   # Convert back to wide format for modeling   step_measure_output_wide(prefix = \"nir_\")"},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"preparing-and-applying-the-recipe","dir":"","previous_headings":"Usage","what":"Preparing and applying the recipe","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"","code":"# Prep learns any parameters from training data prepped <- prep(rec)  # Bake applies the transformations processed <- bake(prepped, new_data = NULL)  # Result is ready for modeling processed[1:5, 1:8] #> # A tibble: 5 × 8 #>      id water   fat protein  nir_01  nir_02  nir_03  nir_04 #>   <int> <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #> 1     1  60.5  22.5    16.7 -0.126  -0.110  -0.0928 -0.0745 #> 2     2  46    40.1    13.5  0.0184  0.0381  0.0601  0.0841 #> 3     3  71     8.4    20.5  0.105   0.114   0.125   0.136  #> 4     4  72.8   5.9    20.7  0.0716  0.0786  0.0871  0.0974 #> 5     5  58.3  25.5    15.5 -0.132  -0.118  -0.101  -0.0817"},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"visualizing-the-preprocessing","dir":"","previous_headings":"Usage","what":"Visualizing the preprocessing","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"","code":"# Get data at intermediate step (before output conversion) rec_for_viz <- recipe(water + fat + protein ~ ., data = meats_long) |> update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   step_measure_savitzky_golay(window_side = 5, differentiation_order = 1) |>   step_measure_snv()  processed_long <- bake(prep(rec_for_viz), new_data = NULL)  # Extract and plot a few spectra library(tidyr) library(dplyr)  plot_data <- processed_long |>   slice(1:10) |>   mutate(sample_id = row_number()) |>   unnest(.measures)  ggplot(plot_data, aes(x = location, y = value, group = sample_id, color = factor(sample_id))) +   geom_line(alpha = 0.7) +   labs(     x = \"Channel\",     y = \"Preprocessed Signal\",     title = \"NIR Spectra After Preprocessing\",     subtitle = \"Savitzky-Golay first derivative + SNV normalization\",     color = \"Sample\"   ) +   theme_minimal() +   theme(legend.position = \"none\")"},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"input-steps","dir":"","previous_headings":"Available Steps","what":"Input Steps","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"Convert data measure’s internal format:","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"processing-steps","dir":"","previous_headings":"Available Steps","what":"Processing Steps","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"Apply spectral preprocessing:","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"output-steps","dir":"","previous_headings":"Available Steps","what":"Output Steps","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"Convert back modeling-ready format:","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"learning-more","dir":"","previous_headings":"","what":"Learning more","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"Getting Started - comprehensive introduction measure Preprocessing Techniques - Deep dive available preprocessing methods","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"related-packages","dir":"","previous_headings":"","what":"Related packages","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"measure builds tidymodels ecosystem: recipes - foundation preprocessing pipelines parsnip - Unified modeling interface workflows - Bundle preprocessing modeling tune - Hyperparameter tuning (works measure’s tunable steps!) spectral analysis R, might also find packages useful: prospectr - Spectral preprocessing functions ChemoSpec - Exploratory chemometrics mdatools - Multivariate data analysis","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"package active development. Contributions welcome! Please see contributing guidelines.","code":""},{"path":"https://jameshwade.github.io/measure/dev/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"A Recipes-style Interface to Tidymodels for Analytical Measurements","text":"Please note measure project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/find_measure_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Find measure columns in a data frame — find_measure_cols","title":"Find measure columns in a data frame — find_measure_cols","text":"Finds columns data frame contain measurement data (.e., class measure_list).","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/find_measure_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find measure columns in a data frame — find_measure_cols","text":"","code":"find_measure_cols(data)"},{"path":"https://jameshwade.github.io/measure/dev/reference/find_measure_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find measure columns in a data frame — find_measure_cols","text":"data data frame.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/find_measure_cols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find measure columns in a data frame — find_measure_cols","text":"Character vector column names containing measure data. Returns empty character vector measure columns found.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/find_measure_cols.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find measure columns in a data frame — find_measure_cols","text":"","code":"library(recipes)  rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   prep()  result <- bake(rec, new_data = NULL) find_measure_cols(result)  # \".measures\" #> [1] \".measures\""},{"path":"https://jameshwade.github.io/measure/dev/reference/glucose_bioreactors.html","id":null,"dir":"Reference","previous_headings":"","what":"Raman Spectra Bioreactor Data — glucose_bioreactors","title":"Raman Spectra Bioreactor Data — glucose_bioreactors","text":"Kuhn Johnson (2013) used two data sets model glucose yeild large- small-scale bioreactors:","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/glucose_bioreactors.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Raman Spectra Bioreactor Data — glucose_bioreactors","text":"Kuhn Johnson (2020), Feature Engineering Selection, Chapman Hall/CRC . https://bookdown.org/max/FES/ https://github.com/topepo/FES","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/glucose_bioreactors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Raman Spectra Bioreactor Data — glucose_bioreactors","text":"Two tibbles. , 2,651 columns whose names numbers measured assay values (names wave numbers). numeric column glucose outcome data, day number days bioreactor, batch_id reactor identifier (\"L\" large \"S\" small), batch_sample ID day.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/glucose_bioreactors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Raman Spectra Bioreactor Data — glucose_bioreactors","text":"Fifteen small-scale (5 liters) bioreactors seeded cells monitored daily 14 days. Three large-scale bioreactors also seeded cells batch monitored daily 14 days. Samples collected day bioreactors glucose measured. goal create models data numerous small-scale bioreactors evaluate results can accurately predict happening large-scale bioreactors.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/glucose_bioreactors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Raman Spectra Bioreactor Data — glucose_bioreactors","text":"","code":"data(glucose_bioreactors) dim(bioreactors_small) #> [1]  210 2655"},{"path":"https://jameshwade.github.io/measure/dev/reference/has_measure_col.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if data frame has measure column(s) — has_measure_col","title":"Check if data frame has measure column(s) — has_measure_col","text":"Checks whether data frame contains least one measure column. recommended way validate data step functions.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/has_measure_col.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if data frame has measure column(s) — has_measure_col","text":"","code":"has_measure_col(data)"},{"path":"https://jameshwade.github.io/measure/dev/reference/has_measure_col.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if data frame has measure column(s) — has_measure_col","text":"data data frame.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/has_measure_col.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if data frame has measure column(s) — has_measure_col","text":"Invisibly returns names measure columns found. Throws error measure columns found.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/has_measure_col.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if data frame has measure column(s) — has_measure_col","text":"","code":"library(recipes)  rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   prep()  result <- bake(rec, new_data = NULL) has_measure_col(result)  # TRUE (returns invisibly)"},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Test if object is a measure list — is_measure_list","title":"Test if object is a measure list — is_measure_list","text":"Test object measure list","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test if object is a measure list — is_measure_list","text":"","code":"is_measure_list(x)"},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test if object is a measure list — is_measure_list","text":"x Object test.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test if object is a measure list — is_measure_list","text":"Logical indicating x inherits measure_list.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test if object is a measure list — is_measure_list","text":"","code":"# After using step_measure_input_*, the .measures column is a measure_list library(recipes)  rec <- recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   prep()  result <- bake(rec, new_data = NULL) is_measure_list(result$.measures) #> [1] TRUE"},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Test if object is a measure tibble — is_measure_tbl","title":"Test if object is a measure tibble — is_measure_tbl","text":"Test object measure tibble","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test if object is a measure tibble — is_measure_tbl","text":"","code":"is_measure_tbl(x)"},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test if object is a measure tibble — is_measure_tbl","text":"x Object test.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test if object is a measure tibble — is_measure_tbl","text":"Logical indicating x inherits measure_tbl.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/is_measure_tbl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test if object is a measure tibble — is_measure_tbl","text":"","code":"# Create a measure tibble mt <- measure:::new_measure_tbl(location = 1:5, value = rnorm(5)) is_measure_tbl(mt) #> [1] TRUE  # Regular tibbles are not measure tibbles is_measure_tbl(tibble::tibble(location = 1:5, value = rnorm(5))) #> [1] FALSE"},{"path":"https://jameshwade.github.io/measure/dev/reference/measure-package.html","id":null,"dir":"Reference","previous_headings":"","what":"measure: A Recipes-style Interface to Tidymodels for Analytical Measurements — measure-package","title":"measure: A Recipes-style Interface to Tidymodels for Analytical Measurements — measure-package","text":"Analytical measurements...","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/measure-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"measure: A Recipes-style Interface to Tidymodels for Analytical Measurements — measure-package","text":"Maintainer: James Wade github@jameshwade.com (ORCID)","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/meats_long.html","id":null,"dir":"Reference","previous_headings":"","what":"Fat, water and protein content of meat samples — meats_long","title":"Fat, water and protein content of meat samples — meats_long","text":"\"data recorded Tecator Infratec Food Feed Analyzer working wavelength range 850 - 1050 nm Near Infrared Transmission (NIT) principle. sample contains finely chopped pure meat different moisture, fat protein contents.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/meats_long.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fat, water and protein content of meat samples — meats_long","text":"meats_long tibble","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/meats_long.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fat, water and protein content of meat samples — meats_long","text":"results data used publication want mention instrument company name (Tecator) publication.  addition, please send preprint article Karin Thente, Tecator AB, Box 70, S-263 21 Hoganas, Sweden data available public domain responsibility original data source. data can redistributed long permission note attached.\" \"meat sample data consists 100 channel spectrum absorbances contents moisture (water), fat protein.  absorbance -log10 transmittance measured spectrometer. three contents, measured percent, determined analytic chemistry.\" Included meats data transformed long format ","code":"modeldata::meats %>%   rowid_to_column(var = \"id\") %>%   pivot_longer(cols = starts_with(\"x_\"),                names_to = \"channel\",                values_to = \"transmittance\") %>%   mutate(channel = str_extract(channel, \"[:digit:]+\") %>% as.integer())"},{"path":"https://jameshwade.github.io/measure/dev/reference/meats_long.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fat, water and protein content of meat samples — meats_long","text":"","code":"data(meats_long) str(meats_long) #> tibble [21,500 × 6] (S3: tbl_df/tbl/data.frame) #>  $ id           : int [1:21500] 1 1 1 1 1 1 1 1 1 1 ... #>  $ water        : num [1:21500] 60.5 60.5 60.5 60.5 60.5 60.5 60.5 60.5 60.5 60.5 ... #>  $ fat          : num [1:21500] 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 ... #>  $ protein      : num [1:21500] 16.7 16.7 16.7 16.7 16.7 16.7 16.7 16.7 16.7 16.7 ... #>  $ channel      : int [1:21500] 1 2 3 4 5 6 7 8 9 10 ... #>  $ transmittance: num [1:21500] 2.62 2.62 2.62 2.62 2.62 ..."},{"path":"https://jameshwade.github.io/measure/dev/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics tunable","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/required_pkgs.recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Set package dependencies — required_pkgs.recipe","title":"Set package dependencies — required_pkgs.recipe","text":"Set package dependencies","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/required_pkgs.recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set package dependencies — required_pkgs.recipe","text":"","code":"# S3 method for class 'step_measure_savitzky_golay' required_pkgs(x, ...)"},{"path":"https://jameshwade.github.io/measure/dev/reference/required_pkgs.recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set package dependencies — required_pkgs.recipe","text":"x step object. ... used.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_baseline.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit and subtract a baseline from a measurement signal — step_baseline","title":"Fit and subtract a baseline from a measurement signal — step_baseline","text":"Fit subtract baseline measurement signal","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_baseline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit and subtract a baseline from a measurement signal — step_baseline","text":"","code":"step_baseline(   recipe,   ...,   role = NA,   trained = FALSE,   options = NULL,   skip = FALSE,   id = recipes::rand_id(\"measure\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_baseline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit and subtract a baseline from a measurement signal — step_baseline","text":"recipe recipe object. step added sequence operations recipe. ... One selector functions choose variables step. role Assign role new variables. trained logical indicate quantities preprocessing estimated. options list options default method stats::prcomp(). Argument defaults set retx = FALSE, center = FALSE, scale. = FALSE, tol = NULL. Note argument x passed (). skip logical. step skipped recipe baked bake()? operations baked prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_long.html","id":null,"dir":"Reference","previous_headings":"","what":"Ingest Measurements from a Single Column — step_measure_input_long","title":"Ingest Measurements from a Single Column — step_measure_input_long","text":"step_measure_input_long creates specification recipe step converts measures organized column analytical results (option column numeric indices) internal format used package.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ingest Measurements from a Single Column — step_measure_input_long","text":"","code":"step_measure_input_long(   recipe,   ...,   location,   col_name = \".measures\",   pad = FALSE,   role = \"measure\",   trained = FALSE,   columns = NULL,   skip = FALSE,   id = rand_id(\"measure_input_long\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ingest Measurements from a Single Column — step_measure_input_long","text":"recipe recipe object. step added sequence operations recipe. ... One selector functions choose single column contains analytical measurements. selection order measurement's profile. location One selector functions choose single column locations analytical values. col_name single character string specifying name output column contain measure data. Defaults \".measures\". Use different names creating multiple measure columns (e.g., \".uv_spectrum\" \".ms_spectrum\"). pad Whether pad measurements ensure number values. useful missing values measurements. role used step since new variables created. trained logical indicate quantities preprocessing estimated. columns character vector column names determined recipe. skip logical. step skipped recipe baked bake()? operations baked prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_long.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ingest Measurements from a Single Column — step_measure_input_long","text":"step designed data format column analytical measurement (e.g., absorption, etc.) another location value (e.g., wave number, etc.). step_measure_input_long() collect data put format used internally package. data structure row independent experimental unit nested tibble sample's measure (measurement location). assumes unique combinations columns data define individual patterns associated pattern. case, special values might inappropriately restructured. best advice column type indicates unique sample number measure. example, 200 values measure 7 samples, input data (long format) 1,400 rows. advise column 7 unique values indicating rows correspond sample.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_long.html","id":"missing-data","dir":"Reference","previous_headings":"","what":"Missing Data","title":"Ingest Measurements from a Single Column — step_measure_input_long","text":"Currently, measure assumes equal numbers values within sample. missing values measurements, need pad missing values (opposed absent row long format). , error occur.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_long.html","id":"tidying","dir":"Reference","previous_headings":"","what":"Tidying","title":"Ingest Measurements from a Single Column — step_measure_input_long","text":"tidy() step, tibble indicating original columns used reformat data.","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_wide.html","id":null,"dir":"Reference","previous_headings":"","what":"Ingest Measurements in Separate Columns — step_measure_input_wide","title":"Ingest Measurements in Separate Columns — step_measure_input_wide","text":"step_measure_input_wide creates specification recipe step converts measures organized multiple columns internal format used package.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_wide.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ingest Measurements in Separate Columns — step_measure_input_wide","text":"","code":"step_measure_input_wide(   recipe,   ...,   role = \"measure\",   trained = FALSE,   columns = NULL,   location_values = NULL,   col_name = \".measures\",   skip = FALSE,   id = rand_id(\"measure_input_wide\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_wide.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ingest Measurements in Separate Columns — step_measure_input_wide","text":"recipe recipe object. step added sequence operations recipe. ... One selector functions choose variables step. See selections() details. role used step since new variables created. trained logical indicate quantities preprocessing estimated. columns character string selected variable names. field placeholder populated recipes::prep() used. location_values numeric vector values specify location measurements (e.g., wavelength etc.) order variables selected .... specified, sequence integers (starting 1L) used. col_name single character string specifying name output column contain measure data. Defaults \".measures\". Use different names creating multiple measure columns (e.g., \".uv_spectrum\" \".ms_spectrum\"). skip logical. step skipped recipe baked bake()? operations baked prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_wide.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ingest Measurements in Separate Columns — step_measure_input_wide","text":"step designed data format analytical measurements separate columns. step_measure_input_wide() collect data put format used internally package. data structure row independent experimental unit nested tibble sample's measure (measurement location). assumes unique combinations columns data define individual patterns associated pattern. case, special values might inappropriately restructured. best advice column type indicates unique sample number measure. example, 20 rows input data set, columns analytically measurements show duplicate combinations 20 rows.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_wide.html","id":"tidying","dir":"Reference","previous_headings":"","what":"Tidying","title":"Ingest Measurements in Separate Columns — step_measure_input_wide","text":"tidy() step, tibble indicating original columns used reformat data.","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_input_wide.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ingest Measurements in Separate Columns — step_measure_input_wide","text":"","code":"data(meats, package = \"modeldata\")  # Outcome data is to the right names(meats) %>% tail(10) #>  [1] \"x_094\"   \"x_095\"   \"x_096\"   \"x_097\"   \"x_098\"   \"x_099\"   \"x_100\"   #>  [8] \"water\"   \"fat\"     \"protein\"  # ------------------------------------------------------------------------------ # Ingest data without adding the location (i.e. wave number) for the spectra  rec <-   recipe(water + fat + protein ~ ., data = meats) %>%   step_measure_input_wide(starts_with(\"x_\")) %>%   prep()  summary(rec) #> # A tibble: 4 × 4 #>   variable  type      role    source   #>   <chr>     <list>    <chr>   <chr>    #> 1 water     <chr [2]> outcome original #> 2 fat       <chr [2]> outcome original #> 3 protein   <chr [2]> outcome original #> 4 .measures <chr [1]> measure derived   # ------------------------------------------------------------------------------ # Ingest data without adding the location (i.e. wave number) for the spectra  # Make up some locations for the spectra's x-axis index <- seq(1, 2, length.out = 100)  rec <-   recipe(water + fat + protein ~ ., data = meats) %>%   step_measure_input_wide(starts_with(\"x_\"), location_values = index) %>%   prep()  summary(rec) #> # A tibble: 4 × 4 #>   variable  type      role    source   #>   <chr>     <list>    <chr>   <chr>    #> 1 water     <chr [2]> outcome original #> 2 fat       <chr [2]> outcome original #> 3 protein   <chr [2]> outcome original #> 4 .measures <chr [1]> measure derived"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":null,"dir":"Reference","previous_headings":"","what":"Multiplicative Scatter Correction (MSC) — step_measure_msc","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"step_measure_msc() creates specification recipe step applies Multiplicative Scatter Correction spectral data. MSC removes physical light scatter accounting additive multiplicative effects.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"","code":"step_measure_msc(   recipe,   measures = NULL,   role = NA,   trained = FALSE,   ref_spectra = NULL,   skip = FALSE,   id = recipes::rand_id(\"measure_msc\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"recipe recipe object. step added sequence operations recipe. measures optional character vector measure column names process. NULL (default), measure columns (columns class measure_list) processed. Use limit processing specific measure columns working multiple measurement types. role used step since new variables created. trained logical indicate quantities preprocessing estimated. ref_spectra named list numeric vectors containing reference spectra computed training measure column. NULL step trained. skip logical. step skipped recipe baked recipes::bake()? operations baked recipes::prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"updated version recipe new step added sequence existing operations.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"Multiplicative Scatter Correction (MSC) normalization method attempts account additive multiplicative effects aligning spectrum reference spectrum. spectrum \\(x_i\\) reference \\(x_r\\), transformation : $$x_i = m_i \\cdot x_r + a_i$$ $$MSC(x_i) = \\frac{x_i - a_i}{m_i}$$ \\(a_i\\) \\(m_i\\) additive (intercept) multiplicative (slope) terms regressing \\(x_i\\) \\(x_r\\). reference spectrum computed mean training spectra prep() stored use applying transformation new data. MSC commonly used remove physical light scatter effects NIR spectroscopy caused differences particle size path length. selectors supplied step function. data internal format produced step_measure_input_wide() step_measure_input_long(). measurement locations preserved unchanged.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"tidying","dir":"Reference","previous_headings":"","what":"Tidying","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"tidy() step, tibble columns terms (set \".measures\") id returned.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"Geladi, P., MacDougall, D., Martens, H. 1985. Linearization Scatter-Correction Near-Infrared Reflectance Spectra Meat. Applied Spectroscopy, 39(3):491-500.","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_msc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multiplicative Scatter Correction (MSC) — step_measure_msc","text":"","code":"library(recipes)  rec <-   recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   step_measure_msc() |>   prep()  bake(rec, new_data = NULL) #> # A tibble: 215 × 5 #>       id water   fat protein .measures #>    <int> <dbl> <dbl>   <dbl>    <meas> #>  1     1  60.5  22.5    16.7 [100 × 2] #>  2     2  46    40.1    13.5 [100 × 2] #>  3     3  71     8.4    20.5 [100 × 2] #>  4     4  72.8   5.9    20.7 [100 × 2] #>  5     5  58.3  25.5    15.5 [100 × 2] #>  6     6  44    42.7    13.7 [100 × 2] #>  7     7  44    42.7    13.7 [100 × 2] #>  8     8  69.3  10.6    19.3 [100 × 2] #>  9     9  61.4  19.9    17.7 [100 × 2] #> 10    10  61.4  19.9    17.7 [100 × 2] #> # ℹ 205 more rows"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_long.html","id":null,"dir":"Reference","previous_headings":"","what":"Reorganize Measurements to Two Columns — step_measure_output_long","title":"Reorganize Measurements to Two Columns — step_measure_output_long","text":"step_measure_output_long creates specification recipe","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reorganize Measurements to Two Columns — step_measure_output_long","text":"","code":"step_measure_output_long(   recipe,   values_to = \".measure\",   location_to = \".location\",   measures = NULL,   role = \"predictor\",   trained = FALSE,   skip = FALSE,   id = rand_id(\"measure_output_long\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reorganize Measurements to Two Columns — step_measure_output_long","text":"recipe recipe object. step added sequence operations recipe. values_to single character string column containing analytical measurement. location_to single character string column containing location measurement (e.g. wavenumber index). measures optional single character string specifying measure column output. NULL (default) one measure column exists, column used. multiple measure columns exist measures NULL, error thrown prompting specify column output. role used step since new variables created. trained logical indicate quantities preprocessing estimated. skip logical. step skipped recipe baked bake()? operations baked prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_long.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reorganize Measurements to Two Columns — step_measure_output_long","text":"step converts measures format columns measurement corresponding location (.e., \"long\" format). step designed convert analytical measurements internal data structure two column format.","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_long.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reorganize Measurements to Two Columns — step_measure_output_long","text":"","code":"library(dplyr)  data(glucose_bioreactors) bioreactors_small$batch_sample <- NULL  small_tr <- bioreactors_small[1:200, ] small_te <- bioreactors_small[201:210, ]  small_rec <-   recipe(glucose ~ ., data = small_tr) %>%   update_role(batch_id, day, new_role = \"id columns\") %>%   step_measure_input_wide(`400`:`3050`) %>%   prep()  # Before reformatting:  small_rec %>% bake(new_data = small_te) #> # A tibble: 10 × 4 #>    batch_id   day glucose   .measures #>    <chr>    <int>   <dbl>      <meas> #>  1 S_15         5    2.04 [2,651 × 2] #>  2 S_15         6    5.56 [2,651 × 2] #>  3 S_15         7    4.65 [2,651 × 2] #>  4 S_15         8    9.91 [2,651 × 2] #>  5 S_15         9    4.96 [2,651 × 2] #>  6 S_15        10    6.78 [2,651 × 2] #>  7 S_15        11    6.72 [2,651 × 2] #>  8 S_15        12    4.69 [2,651 × 2] #>  9 S_15        13    6.30 [2,651 × 2] #> 10 S_15        14    3.10 [2,651 × 2]  # After reformatting:  output_rec <-   small_rec %>%   step_measure_output_long() %>%   prep()  output_rec %>% bake(new_data = small_te) #> # A tibble: 26,510 × 5 #>    batch_id   day glucose .location .measure #>    <chr>    <int>   <dbl>     <dbl>    <dbl> #>  1 S_15         5    2.04         1  760094. #>  2 S_15         5    2.04         2  779053. #>  3 S_15         5    2.04         3  797154. #>  4 S_15         5    2.04         4  817226. #>  5 S_15         5    2.04         5  832725. #>  6 S_15         5    2.04         6  840075. #>  7 S_15         5    2.04         7  841721. #>  8 S_15         5    2.04         8  832112. #>  9 S_15         5    2.04         9  819494. #> 10 S_15         5    2.04        10  799601. #> # ℹ 26,500 more rows"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_wide.html","id":null,"dir":"Reference","previous_headings":"","what":"Reorganize Measurements to Separate Columns — step_measure_output_wide","title":"Reorganize Measurements to Separate Columns — step_measure_output_wide","text":"step_measure_output_wide creates specification recipe step converts measures multiple columns (.e., \"wide\" format).","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_wide.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reorganize Measurements to Separate Columns — step_measure_output_wide","text":"","code":"step_measure_output_wide(   recipe,   prefix = \"measure_\",   measures = NULL,   role = \"predictor\",   trained = FALSE,   skip = FALSE,   id = rand_id(\"measure_output_wide\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_wide.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reorganize Measurements to Separate Columns — step_measure_output_wide","text":"recipe recipe object. step added sequence operations recipe. prefix character string used name new columns. measures optional single character string specifying measure column output. NULL (default) one measure column exists, column used. multiple measure columns exist measures NULL, error thrown prompting specify column output. role used step since new variables created. trained logical indicate quantities preprocessing estimated. skip logical. step skipped recipe baked bake()? operations baked prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_wide.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reorganize Measurements to Separate Columns — step_measure_output_wide","text":"step designed convert analytical measurements internal data structure separate columns. Wide outputs can helpful want use standard recipes steps measuresments, recipes::step_pca(), recipes::step_pls(), .","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_output_wide.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reorganize Measurements to Separate Columns — step_measure_output_wide","text":"","code":"library(dplyr)  data(glucose_bioreactors) bioreactors_small$batch_sample <- NULL  small_tr <- bioreactors_small[1:200, ] small_te <- bioreactors_small[201:210, ]  small_rec <-   recipe(glucose ~ ., data = small_tr) %>%   update_role(batch_id, day, new_role = \"id columns\") %>%   step_measure_input_wide(`400`:`3050`) %>%   prep()  # Before reformatting:  small_rec %>% bake(new_data = small_te) #> # A tibble: 10 × 4 #>    batch_id   day glucose   .measures #>    <chr>    <int>   <dbl>      <meas> #>  1 S_15         5    2.04 [2,651 × 2] #>  2 S_15         6    5.56 [2,651 × 2] #>  3 S_15         7    4.65 [2,651 × 2] #>  4 S_15         8    9.91 [2,651 × 2] #>  5 S_15         9    4.96 [2,651 × 2] #>  6 S_15        10    6.78 [2,651 × 2] #>  7 S_15        11    6.72 [2,651 × 2] #>  8 S_15        12    4.69 [2,651 × 2] #>  9 S_15        13    6.30 [2,651 × 2] #> 10 S_15        14    3.10 [2,651 × 2]  # After reformatting:  output_rec <-   small_rec %>%   step_measure_output_wide() %>%   prep()  output_rec %>% bake(new_data = small_te) #> # A tibble: 10 × 2,654 #>    batch_id   day glucose measure_0001 measure_0002 measure_0003 measure_0004 #>    <chr>    <int>   <dbl>        <dbl>        <dbl>        <dbl>        <dbl> #>  1 S_15         5    2.04      760094.      779053.      797154.      817226. #>  2 S_15         6    5.56      854812.      874105.      893653.      912190. #>  3 S_15         7    4.65      961786.      979449.     1000054.     1019400. #>  4 S_15         8    9.91     1092681.     1110867.     1132371.     1151944. #>  5 S_15         9    4.96     1243318.     1259961.     1281630.     1301011. #>  6 S_15        10    6.78     1500414.     1517867.     1536436.     1557016. #>  7 S_15        11    6.72     1818328.     1836446.     1856983.     1876906. #>  8 S_15        12    4.69     2035750.     2053903.     2073901.     2093514. #>  9 S_15        13    6.30     2192191.     2211502.     2230969.     2251089. #> 10 S_15        14    3.10     2353638.     2371877.     2392865.     2412822. #> # ℹ 2,647 more variables: measure_0005 <dbl>, measure_0006 <dbl>, #> #   measure_0007 <dbl>, measure_0008 <dbl>, measure_0009 <dbl>, #> #   measure_0010 <dbl>, measure_0011 <dbl>, measure_0012 <dbl>, #> #   measure_0013 <dbl>, measure_0014 <dbl>, measure_0015 <dbl>, #> #   measure_0016 <dbl>, measure_0017 <dbl>, measure_0018 <dbl>, #> #   measure_0019 <dbl>, measure_0020 <dbl>, measure_0021 <dbl>, #> #   measure_0022 <dbl>, measure_0023 <dbl>, measure_0024 <dbl>, …"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":null,"dir":"Reference","previous_headings":"","what":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"step_measure_savitzky_golay creates specification recipe step smooths filters measurement sequence.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"","code":"step_measure_savitzky_golay(   recipe,   measures = NULL,   role = NA,   trained = FALSE,   degree = 3,   window_side = 11,   differentiation_order = 0,   skip = FALSE,   id = rand_id(\"measure_savitzky_golay\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"recipe recipe object. step added sequence operations recipe. measures optional character vector measure column names process. NULL (default), measure columns (columns class measure_list) processed. Use limit processing specific measure columns working multiple measurement types. role used step since new variables created. trained logical indicate quantities preprocessing estimated. degree integer polynomial degree use smoothing. window_side integer many units side window. means window_side = 1 total window width 3 (e.g., width 2 * window_side + 1). differentiation_order integer degree filtering (zero indicates differentiation). skip logical. step skipped recipe baked recipes::bake()? operations baked recipes::prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"updated version recipe new step added sequence existing operations.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"method can smooth random noise reduce -predictor correlation. fits polynomial window measurements results fewer measurements input. Measurements assumed equally spaced. polynomial degree less window size. Also, window size must greater polynomial degree. either case true, original argument values increased satisfy conditions (warning). selectors supplied step function. data special internal format produced step_measure_input_wide() step_measure_input_long(). measurement locations reset integer indices starting one.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":"tidying","dir":"Reference","previous_headings":"","what":"Tidying","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"tidy() step, tibble columns  returned.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_savitzky_golay.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Savitzky-Golay Pre-Processing — step_measure_savitzky_golay","text":"","code":"if (rlang::is_installed(\"prospectr\")) {   rec <-     recipe(water + fat + protein ~ ., data = meats_long) %>%     update_role(id, new_role = \"id\") %>%     step_measure_input_long(transmittance, location = vars(channel)) %>%     step_measure_savitzky_golay(       differentiation_order = 1,       degree = 3,       window_side = 5     ) %>%     prep() }"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":null,"dir":"Reference","previous_headings":"","what":"Standard Normal Variate (SNV) Transformation — step_measure_snv","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"step_measure_snv() creates specification recipe step applies Standard Normal Variate transformation spectral data. SNV normalizes spectrum zero mean unit standard deviation.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"","code":"step_measure_snv(   recipe,   measures = NULL,   role = NA,   trained = FALSE,   skip = FALSE,   id = recipes::rand_id(\"measure_snv\") )"},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"recipe recipe object. step added sequence operations recipe. measures optional character vector measure column names process. NULL (default), measure columns (columns class measure_list) processed. Use limit processing specific measure columns working multiple measurement types. role used step since new variables created. trained logical indicate quantities preprocessing estimated. skip logical. step skipped recipe baked recipes::bake()? operations baked recipes::prep() run, operations may able conducted new data (e.g. processing outcome variable(s)). Care taken using skip = TRUE may affect computations subsequent operations. id character string unique step identify .","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"updated version recipe new step added sequence existing operations.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"Standard Normal Variate (SNV) row-wise transformation normalizes spectrum independently. spectrum \\(x\\), transformation : $$SNV(x) = \\frac{x - \\bar{x}}{s_x}$$ \\(\\bar{x}\\) mean \\(s_x\\) standard deviation spectrum values. SNV commonly used remove multiplicative effects scatter particle size NIR spectroscopy. SNV transformation, spectrum mean zero standard deviation one. selectors supplied step function. data internal format produced step_measure_input_wide() step_measure_input_long(). measurement locations preserved unchanged.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":"tidying","dir":"Reference","previous_headings":"","what":"Tidying","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"tidy() step, tibble column terms (set \".measures\") id returned.","code":""},{"path":[]},{"path":"https://jameshwade.github.io/measure/dev/reference/step_measure_snv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Standard Normal Variate (SNV) Transformation — step_measure_snv","text":"","code":"library(recipes)  rec <-   recipe(water + fat + protein ~ ., data = meats_long) |>   update_role(id, new_role = \"id\") |>   step_measure_input_long(transmittance, location = vars(channel)) |>   step_measure_snv() |>   prep()  bake(rec, new_data = NULL) #> # A tibble: 215 × 5 #>       id water   fat protein .measures #>    <int> <dbl> <dbl>   <dbl>    <meas> #>  1     1  60.5  22.5    16.7 [100 × 2] #>  2     2  46    40.1    13.5 [100 × 2] #>  3     3  71     8.4    20.5 [100 × 2] #>  4     4  72.8   5.9    20.7 [100 × 2] #>  5     5  58.3  25.5    15.5 [100 × 2] #>  6     6  44    42.7    13.7 [100 × 2] #>  7     7  44    42.7    13.7 [100 × 2] #>  8     8  69.3  10.6    19.3 [100 × 2] #>  9     9  61.4  19.9    17.7 [100 × 2] #> 10    10  61.4  19.9    17.7 [100 × 2] #> # ℹ 205 more rows"},{"path":"https://jameshwade.github.io/measure/dev/reference/subtract_rf_baseline.html","id":null,"dir":"Reference","previous_headings":"","what":"Subtract baseline using robust fitting method — subtract_rf_baseline","title":"Subtract baseline using robust fitting method — subtract_rf_baseline","text":"Subtract baseline using robust fitting method","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/subtract_rf_baseline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subtract baseline using robust fitting method — subtract_rf_baseline","text":"","code":"subtract_rf_baseline(data, yvar, span = 2/3, maxit = c(5, 5))"},{"path":"https://jameshwade.github.io/measure/dev/reference/subtract_rf_baseline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subtract baseline using robust fitting method — subtract_rf_baseline","text":"data dataframe containing variable baseline subtraction yvar name column baseline subtraction span Controls amount smoothing based fraction data use computing fitted value, defaults 2/3. maxit number iterations use robust fit, defaults c(5, 5) first value specifies iterations asymmetric weighting function second value symmetric weighting function.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/subtract_rf_baseline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subtract baseline using robust fitting method — subtract_rf_baseline","text":"dataframe matching column data plus raw baseline columns","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/subtract_rf_baseline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subtract baseline using robust fitting method — subtract_rf_baseline","text":"","code":"meats_long %>% subtract_rf_baseline(yvar = transmittance) #> # A tibble: 21,500 × 8 #>       id water   fat protein channel transmittance   raw baseline #>    <int> <dbl> <dbl>   <dbl>   <int>         <dbl> <dbl>    <dbl> #>  1     1  60.5  22.5    16.7       1        -0.532  2.62     3.15 #>  2     1  60.5  22.5    16.7       2        -0.532  2.62     3.15 #>  3     1  60.5  22.5    16.7       3        -0.531  2.62     3.15 #>  4     1  60.5  22.5    16.7       4        -0.531  2.62     3.15 #>  5     1  60.5  22.5    16.7       5        -0.530  2.62     3.15 #>  6     1  60.5  22.5    16.7       6        -0.529  2.62     3.15 #>  7     1  60.5  22.5    16.7       7        -0.528  2.62     3.15 #>  8     1  60.5  22.5    16.7       8        -0.527  2.62     3.15 #>  9     1  60.5  22.5    16.7       9        -0.525  2.63     3.15 #> 10     1  60.5  22.5    16.7      10        -0.523  2.63     3.15 #> # ℹ 21,490 more rows"},{"path":"https://jameshwade.github.io/measure/dev/reference/tidy.recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidiers for measure steps — tidy.step_measure_input_long","title":"Tidiers for measure steps — tidy.step_measure_input_long","text":"Tidiers measure steps","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/tidy.recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidiers for measure steps — tidy.step_measure_input_long","text":"","code":"# S3 method for class 'step_measure_input_long' tidy(x, ...)  # S3 method for class 'step_measure_input_wide' tidy(x, ...)  # S3 method for class 'step_measure_msc' tidy(x, ...)  # S3 method for class 'step_measure_output_long' tidy(x, ...)  # S3 method for class 'step_measure_output_wide' tidy(x, ...)  # S3 method for class 'step_measure_savitzky_golay' tidy(x, ...)  # S3 method for class 'step_measure_snv' tidy(x, ...)"},{"path":"https://jameshwade.github.io/measure/dev/reference/tidy.recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidiers for measure steps — tidy.step_measure_input_long","text":"x step object. ... used.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/tunable_measure.html","id":null,"dir":"Reference","previous_headings":"","what":"tunable methods for measure — tunable_measure","title":"tunable methods for measure — tunable_measure","text":"functions define parameters can tuned specific steps. also define recommended objects dials package can used generate new parameter values characteristics.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/tunable_measure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"tunable methods for measure — tunable_measure","text":"","code":"# S3 method for class 'step_measure_savitzky_golay' tunable(x, ...)"},{"path":"https://jameshwade.github.io/measure/dev/reference/tunable_measure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"tunable methods for measure — tunable_measure","text":"x recipe step object ... used.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/tunable_measure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"tunable methods for measure — tunable_measure","text":"tibble object.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/vctrs-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"vctrs methods for measure classes — print.measure_tbl","title":"vctrs methods for measure classes — print.measure_tbl","text":"methods enable nice printing measure objects tibbles.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/vctrs-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"vctrs methods for measure classes — print.measure_tbl","text":"","code":"# S3 method for class 'measure_tbl' print(x, ..., n = NULL, width = NULL)  # S3 method for class 'measure_tbl' vec_ptype_abbr(x, ...)  # S3 method for class 'measure_list' print(x, ...)  # S3 method for class 'measure_list' vec_ptype_abbr(x, ...)  # S3 method for class 'measure_list' vec_ptype_full(x, ...)  # S3 method for class 'measure_list' format(x, ...)  # S3 method for class 'measure_list' obj_print_data(x, ...)  # S3 method for class 'measure_list' x[i, ...]  # S3 method for class 'measure_list' x[[i, ...]]  # S3 method for class 'measure_list' c(...)"},{"path":"https://jameshwade.github.io/measure/dev/reference/vctrs-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"vctrs methods for measure classes — print.measure_tbl","text":"x measure_list measure_tbl object. ... Additional arguments (unused).","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/window_side.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameter for measure steps — window_side","title":"Parameter for measure steps — window_side","text":"window_side() differentiation_order() used Savitzky-Golay processing.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/window_side.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameter for measure steps — window_side","text":"","code":"window_side(range = c(1L, 5L), trans = NULL)  differentiation_order(range = c(0L, 4L), trans = NULL)"},{"path":"https://jameshwade.github.io/measure/dev/reference/window_side.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameter for measure steps — window_side","text":"range two-element vector holding defaults smallest largest possible values, respectively. transformation specified, values transformed units. trans trans object scales package, scales::transform_log10() scales::transform_reciprocal(). provided, default used matches units used range. transformation, NULL.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/window_side.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parameter for measure steps — window_side","text":"function classes \"quant_param\" \"param\".","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/window_side.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parameter for measure steps — window_side","text":"parameter often used correct zero-count data tables proportions.","code":""},{"path":"https://jameshwade.github.io/measure/dev/reference/window_side.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parameter for measure steps — window_side","text":"","code":"window_side() #> Window Size (one side) (quantitative) #> Range: [1, 5] differentiation_order() #> Differentiation Order (quantitative) #> Range: [0, 4]"}]
