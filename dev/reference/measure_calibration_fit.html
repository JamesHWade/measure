<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a Calibration Curve — measure_calibration_fit • measure</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Calibration Curve — measure_calibration_fit"><meta name="description" content="Fits a weighted or unweighted calibration curve for quantitation.
Supports linear and quadratic models with various weighting schemes."><meta property="og:description" content="Fits a weighted or unweighted calibration curve for quantitation.
Supports linear and quadratic models with various weighting schemes."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">measure</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.0.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/measure.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/measure.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/preprocessing.html">Preprocessing Techniques</a></li>
    <li><a class="dropdown-item" href="../articles/recipes.html">Integrating with tidymodels</a></li>
    <li><a class="dropdown-item" href="../articles/roles-diagnostics.html">Data Organization &amp; Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Analytical Validation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/baseline.html">Baseline Correction</a></li>
    <li><a class="dropdown-item" href="../articles/sec-analysis-example.html">Bioreactor Case Study</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer</h6></li>
    <li><a class="dropdown-item" href="../articles/internals.html">Internal Class System</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JamesHWade/measure/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit a Calibration Curve</h1>
      <small class="dont-index">Source: <a href="https://github.com/JamesHWade/measure/blob/main/R/calibration-fit.R" class="external-link"><code>R/calibration-fit.R</code></a></small>
      <div class="d-none name"><code>measure_calibration_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a weighted or unweighted calibration curve for quantitation.
Supports linear and quadratic models with various weighting schemes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">measure_calibration_fit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"quadratic"</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"1/x"</span>, <span class="st">"1/x2"</span>, <span class="st">"1/y"</span>, <span class="st">"1/y2"</span><span class="op">)</span>,</span>
<span>  origin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outlier_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"studentized"</span>, <span class="st">"cook"</span><span class="op">)</span>,</span>
<span>  outlier_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outlier_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flag"</span>, <span class="st">"remove"</span><span class="op">)</span>,</span>
<span>  sample_type_col <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing calibration data.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula specifying the model. The left-hand side should
be the response variable, and the right-hand side should be the
concentration variable (e.g., <code>response ~ nominal_conc</code>).</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Model type: <code>"linear"</code> (default) or <code>"quadratic"</code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Weighting scheme:</p><ul><li><p><code>"none"</code> (default): Unweighted regression</p></li>
<li><p><code>"1/x"</code>: Weight by 1/concentration</p></li>
<li><p><code>"1/x2"</code>: Weight by 1/concentration^2</p></li>
<li><p><code>"1/y"</code>: Weight by 1/response</p></li>
<li><p><code>"1/y2"</code>: Weight by 1/response^2</p></li>
<li><p>A numeric vector of custom weights (must match data rows)</p></li>
</ul></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>Logical. If TRUE, force the curve through the origin (zero
intercept). Default is FALSE.</p></dd>


<dt id="arg-outlier-method">outlier_method<a class="anchor" aria-label="anchor" href="#arg-outlier-method"></a></dt>
<dd><p>Method for flagging outliers:</p><ul><li><p><code>"none"</code> (default): No outlier detection</p></li>
<li><p><code>"studentized"</code>: Flag points with |studentized residual| &gt; <code>outlier_threshold</code></p></li>
<li><p><code>"cook"</code>: Flag points with Cook's distance &gt; <code>outlier_threshold</code></p></li>
</ul></dd>


<dt id="arg-outlier-threshold">outlier_threshold<a class="anchor" aria-label="anchor" href="#arg-outlier-threshold"></a></dt>
<dd><p>Threshold for outlier detection. Default is 2.5
for studentized residuals or 1 for Cook's distance.</p></dd>


<dt id="arg-outlier-action">outlier_action<a class="anchor" aria-label="anchor" href="#arg-outlier-action"></a></dt>
<dd><p>What to do with outliers:</p><ul><li><p><code>"flag"</code> (default): Flag but include in fit</p></li>
<li><p><code>"remove"</code>: Remove from fit (with audit trail)</p></li>
</ul></dd>


<dt id="arg-sample-type-col">sample_type_col<a class="anchor" aria-label="anchor" href="#arg-sample-type-col"></a></dt>
<dd><p>Optional column name for sample type. If provided,
only rows with <code>sample_type == "standard"</code> are used for fitting.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="measure_calibration.html">measure_calibration</a> object containing the fitted model,
diagnostics, and metadata.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="weighting">Weighting<a class="anchor" aria-label="anchor" href="#weighting"></a></h3>


<p>Weighting is essential when response variance changes with concentration
(heteroscedasticity). Common patterns:</p><ul><li><p>Constant CV: Use <code>"1/x2"</code> or <code>"1/y2"</code></p></li>
<li><p>Constant absolute error: Use <code>"none"</code></p></li>
<li><p>Proportional error: Use <code>"1/x"</code> or <code>"1/y"</code></p></li>
</ul></div>

<div class="section">
<h3 id="outlier-handling">Outlier Handling<a class="anchor" aria-label="anchor" href="#outlier-handling"></a></h3>


<p>By default, outliers are flagged but NOT removed. This follows the
principle of "flag, don't drop" for analytical data. If removal is
enabled, the removed points are stored in the result for audit purposes.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="measure_calibration_predict.html">measure_calibration_predict()</a></code> for prediction,
<code><a href="autoplot.measure_calibration.html">autoplot.measure_calibration()</a></code> for diagnostic plots,
<code><a href="tidy.measure_calibration.html">tidy.measure_calibration()</a></code> for extracting coefficients.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simple linear calibration</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nominal_conc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">15.2</span>, <span class="fl">35.8</span>, <span class="fl">72.1</span>, <span class="fl">148.3</span>, <span class="fl">295.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal</span> <span class="op">&lt;-</span> <span class="fu">measure_calibration_fit</span><span class="op">(</span><span class="va">data</span>, <span class="va">response</span> <span class="op">~</span> <span class="va">nominal_conc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;measure_calibration&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Weighting: none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Formula: response ~ nominal_conc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N points: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   R²: 0.99992</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Weighted calibration (1/x^2)</span></span></span>
<span class="r-in"><span><span class="va">cal_weighted</span> <span class="op">&lt;-</span> <span class="fu">measure_calibration_fit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  <span class="va">response</span> <span class="op">~</span> <span class="va">nominal_conc</span>,</span></span>
<span class="r-in"><span>  weights <span class="op">=</span> <span class="st">"1/x2"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quadratic model</span></span></span>
<span class="r-in"><span><span class="va">cal_quad</span> <span class="op">&lt;-</span> <span class="fu">measure_calibration_fit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  <span class="va">response</span> <span class="op">~</span> <span class="va">nominal_conc</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"quadratic"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Wade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

